<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2438.4px" preserveAspectRatio="none" style="width:1285px;height:2438px;" version="1.1" viewBox="0 0 1285 2438" width="1285.2px" zoomAndPan="magnify"><defs><filter height="300%" id="fmoi6pl9o1b93" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.4"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.8" dy="4.8" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fmoi6pl9o1b93)" height="94.8656" style="stroke: #000000; stroke-width: 2.4;" width="312" x="15.6" y="344.0625"/><rect fill="#FFFFFF" filter="url(#fmoi6pl9o1b93)" height="94.8656" style="stroke: #000000; stroke-width: 2.4;" width="301.2" x="15.6" y="1021.6781"/><rect fill="#FFFFFF" filter="url(#fmoi6pl9o1b93)" height="167.7094" style="stroke: #000000; stroke-width: 2.4;" width="277.8" x="981" y="1410.7406"/><rect fill="#FFFFFF" filter="url(#fmoi6pl9o1b93)" height="167.7094" style="stroke: #000000; stroke-width: 2.4;" width="277.8" x="981" y="1595.25"/><rect fill="#FFFFFF" filter="url(#fmoi6pl9o1b93)" height="94.8656" style="stroke: #000000; stroke-width: 2.4;" width="301.2" x="15.6" y="1945.0688"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="45.6" x2="45.6" y1="105.1313" y2="2424.5531"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="195" x2="195" y1="105.1313" y2="2424.5531"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="312.6" x2="312.6" y1="105.1313" y2="2424.5531"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="689.4" x2="689.4" y1="105.1313" y2="2424.5531"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1051.8" x2="1051.8" y1="105.1313" y2="2424.5531"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1225.2" x2="1225.2" y1="105.1313" y2="2424.5531"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="24" x="30" y="101.4398">PO</text><ellipse cx="45.6" cy="15.6" fill="#FEFECE" filter="url(#fmoi6pl9o1b93)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 2.4;"/><path d="M45.6,25.2 L45.6,57.6 M30,34.8 L61.2,34.8 M45.6,57.6 L30,75.6 M45.6,57.6 L61.2,75.6 " fill="none" filter="url(#fmoi6pl9o1b93)" style="stroke: #A80036; stroke-width: 2.4;"/><rect fill="#FEFECE" filter="url(#fmoi6pl9o1b93)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="102" x="142.2" y="61.2"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="85.2" x="150.6" y="87.0398">PO Reader</text><rect fill="#FEFECE" filter="url(#fmoi6pl9o1b93)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="98.4" x="261" y="40.0688"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="68.4" x="276" y="65.9086">Ticketing</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="81.6" x="269.4" y="87.0398">application</text><rect fill="#FEFECE" filter="url(#fmoi6pl9o1b93)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="112.8" x="630.6" y="40.0688"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="61.2" x="656.4" y="65.9086">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="96" x="639" y="87.0398">Terminal API</text><rect fill="#FEFECE" filter="url(#fmoi6pl9o1b93)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="112.8" x="993" y="61.2"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="96" x="1001.4" y="87.0398">SAM Reader</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="34.8" x="1204.8" y="101.4398">SAM</text><ellipse cx="1225.8" cy="15.6" fill="#FEFECE" filter="url(#fmoi6pl9o1b93)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 2.4;"/><path d="M1225.8,25.2 L1225.8,57.6 M1210.2,34.8 L1241.4,34.8 M1225.8,57.6 L1210.2,75.6 M1225.8,57.6 L1241.4,75.6 " fill="none" filter="url(#fmoi6pl9o1b93)" style="stroke: #A80036; stroke-width: 2.4;"/><rect fill="#EEEEEE" filter="url(#fmoi6pl9o1b93)" height="3.6" style="stroke: #EEEEEE; stroke-width: 1.2;" width="1267.2" x="3.6" y="142.5422"/><line style="stroke: #000000; stroke-width: 1.2;" x1="3.6" x2="1270.8" y1="142.5422" y2="142.5422"/><line style="stroke: #000000; stroke-width: 1.2;" x1="3.6" x2="1270.8" y1="146.1422" y2="146.1422"/><rect fill="#EEEEEE" filter="url(#fmoi6pl9o1b93)" height="29.2219" style="stroke: #000000; stroke-width: 2.4;" width="148.8" x="562.8" y="129.1313"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127.2" x="570" y="150.1254">PO Identification</text><polygon fill="#A80036" points="675,211.9969,687,216.7969,675,221.5969,679.8,216.7969" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="682.2" y1="216.7969" y2="216.7969"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="172.8" x="321" y="191.3473">transmit(SeRequest(AID,</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="212.4" x="321" y="210.9691">List&lt;PoRequestOutSession&gt;))</text><polygon fill="#0000FF" points="208.8,248.4188,196.8,253.2188,208.8,258.0188,204,253.2188" style="stroke: #0000FF; stroke-width: 1.2;"/><line style="stroke: #0000FF; stroke-width: 1.2;" x1="201.6" x2="688.2" y1="253.2188" y2="253.2188"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="304.8" x="216" y="247.391">PO 1: SeRequest(AID, List&lt;ApduRequest&gt;)</text><polygon fill="#A80036" points="58.8,284.8406,46.8,289.6406,58.8,294.4406,54,289.6406" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="51.6" x2="194.4" y1="289.6406" y2="289.6406"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="121.2" x="66" y="283.8129">SelectApplication</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="326.0625" y2="321.2625"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="326.0625" y2="330.8625"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="45.6" x2="194.4" y1="326.0625" y2="326.0625"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="54" y="320.2348">PO serial</text><path d="M15.6,344.0625 L321.6,344.0625 L321.6,353.6625 L309.6,365.6625 L15.6,365.6625 L15.6,344.0625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="94.8656" style="stroke: #000000; stroke-width: 2.4;" width="312" x="15.6" y="344.0625"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="252" x="33.6" y="361.4566">'x' PO commands outside session</text><polygon fill="#A80036" points="58.8,388.1063,46.8,392.9063,58.8,397.7063,54,392.9063" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="51.6" x2="194.4" y1="392.9063" y2="392.9063"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="66" y="387.0785">ApduRequest</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="429.3281" y2="424.5281"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="429.3281" y2="434.1281"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="45.6" x2="194.4" y1="429.3281" y2="429.3281"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="54" y="423.5004">ApduResponse</text><polygon fill="#0000FF" points="675,469.35,687,474.15,675,478.95,679.8,474.15" style="stroke: #0000FF; stroke-width: 1.2;"/><line style="stroke: #0000FF; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="195.6" x2="682.2" y1="474.15" y2="474.15"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="282" x="204" y="468.3223">SeResponse(FCI, List&lt;ApduResponse&gt;)</text><polygon fill="#A80036" points="325.8,505.7719,313.8,510.5719,325.8,515.3719,321,510.5719" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="318.6" x2="688.2" y1="510.5719" y2="510.5719"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="301.2" x="333" y="504.7441">SeResponse(PO_FCI, List&lt;PoResponse&gt;))</text><rect fill="#EEEEEE" filter="url(#fmoi6pl9o1b93)" height="3.6" style="stroke: #EEEEEE; stroke-width: 1.2;" width="1267.2" x="3.6" y="545.5828"/><line style="stroke: #000000; stroke-width: 1.2;" x1="3.6" x2="1270.8" y1="545.5828" y2="545.5828"/><line style="stroke: #000000; stroke-width: 1.2;" x1="3.6" x2="1270.8" y1="549.1828" y2="549.1828"/><rect fill="#EEEEEE" filter="url(#fmoi6pl9o1b93)" height="29.2219" style="stroke: #000000; stroke-width: 2.4;" width="166.8" x="553.8" y="532.1719"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="561" y="553.166">PO Secure Session</text><polygon fill="#A80036" points="675,615.0375,687,619.8375,675,624.6375,679.8,619.8375" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="682.2" y1="619.8375" y2="619.8375"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122.4" x="321" y="594.3879">processOpening</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="225.6" x="443.4" y="594.3879">(PO_FCI, OpenSessionRequest,</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="194.4" x="321" y="614.0098">List&lt;PoRequestInSession&gt;)</text><polygon fill="#00FF00" points="1037.4,671.0813,1049.4,675.8813,1037.4,680.6813,1042.2,675.8813" style="stroke: #00FF00; stroke-width: 1.2;"/><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="1044.6" y1="675.8813" y2="675.8813"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="186" x="697.8" y="650.4316">CSM 1: SeRequest(noAID,</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="142.8" x="697.8" y="670.0535">List&lt;ApduRequest&gt;)</text><polygon fill="#A80036" points="1211.4,707.5031,1223.4,712.3031,1211.4,717.1031,1216.2,712.3031" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="712.3031" y2="712.3031"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="110.4" x="1060.2" y="706.4754">SelectDiversifier</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="748.725" y2="743.925"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="748.725" y2="753.525"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="748.725" y2="748.725"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="1072.2" y="742.8973">ack</text><polygon fill="#A80036" points="1211.4,780.3469,1223.4,785.1469,1211.4,789.9469,1216.2,785.1469" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="785.1469" y2="785.1469"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="1060.2" y="779.3191">GetChallenge</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="821.5688" y2="816.7688"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="821.5688" y2="826.3688"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="821.5688" y2="821.5688"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="1072.2" y="815.741">CSM challenge</text><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="701.4" y1="857.9906" y2="853.1906"/><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="701.4" y1="857.9906" y2="862.7906"/><line style="stroke: #00FF00; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="689.4" x2="1050.6" y1="857.9906" y2="857.9906"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="282" x="709.8" y="852.1629">SeResponse(FCI, List&lt;ApduResponse&gt;)</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="324.6" y1="894.4125" y2="889.6125"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="324.6" y1="894.4125" y2="899.2125"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="312.6" x2="688.2" y1="894.4125" y2="894.4125"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="171.6" x="333" y="888.5848">SessionStatus_Identified</text><polygon fill="#0000FF" points="208.8,926.0344,196.8,930.8344,208.8,935.6344,204,930.8344" style="stroke: #0000FF; stroke-width: 1.2;"/><line style="stroke: #0000FF; stroke-width: 1.2;" x1="201.6" x2="688.2" y1="930.8344" y2="930.8344"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="304.8" x="216" y="925.0066">PO 2: SeRequest(AID, List&lt;ApduRequest&gt;)</text><polygon fill="#A80036" points="58.8,962.4563,46.8,967.2562,58.8,972.0563,54,967.2562" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="51.6" x2="194.4" y1="967.2562" y2="967.2562"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="66" y="961.4285">OpenSession</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="1003.6781" y2="998.8781"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="1003.6781" y2="1008.4781"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="45.6" x2="194.4" y1="1003.6781" y2="1003.6781"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="54" y="997.8504">PO challenge</text><path d="M15.6,1021.6781 L310.8,1021.6781 L310.8,1031.2781 L298.8,1043.2781 L15.6,1043.2781 L15.6,1021.6781 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="94.8656" style="stroke: #000000; stroke-width: 2.4;" width="301.2" x="15.6" y="1021.6781"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241.2" x="33.6" y="1039.0723">'y' PO commands inside session</text><polygon fill="#A80036" points="58.8,1065.7219,46.8,1070.5219,58.8,1075.3219,54,1070.5219" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="51.6" x2="194.4" y1="1070.5219" y2="1070.5219"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="66" y="1064.6941">ApduRequest</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="1106.9438" y2="1102.1438"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="1106.9438" y2="1111.7437"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="45.6" x2="194.4" y1="1106.9438" y2="1106.9438"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="54" y="1101.116">ApduResponse</text><polygon fill="#0000FF" points="675,1146.9656,687,1151.7656,675,1156.5656,679.8,1151.7656" style="stroke: #0000FF; stroke-width: 1.2;"/><line style="stroke: #0000FF; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="195.6" x2="682.2" y1="1151.7656" y2="1151.7656"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="282" x="204" y="1145.9379">SeResponse(FCI, List&lt;ApduResponse&gt;)</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="324.6" y1="1188.1875" y2="1183.3875"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="324.6" y1="1188.1875" y2="1192.9875"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="312.6" x2="688.2" y1="1188.1875" y2="1188.1875"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="282" x="333" y="1182.3598">SessionState_Open, List&lt;PoResponse&gt;</text><polygon fill="#A80036" points="675,1259.0531,687,1263.8531,675,1268.6531,679.8,1263.8531" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="682.2" y1="1263.8531" y2="1263.8531"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="321" y="1218.7816">processClosing</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="199.2" x="435" y="1218.7816">(List&lt;PoRequestInSession&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="216" x="321" y="1238.4035">List&lt;AnticipatedPoResponse&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="171.6" x="321" y="1258.0254">PoRatificationCommand)</text><polygon fill="#00FF00" points="1037.4,1315.0969,1049.4,1319.8969,1037.4,1324.6969,1042.2,1319.8969" style="stroke: #00FF00; stroke-width: 1.2;"/><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="1044.6" y1="1319.8969" y2="1319.8969"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="186" x="697.8" y="1294.4473">CSM 2: SeRequest(noAID,</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="142.8" x="697.8" y="1314.0691">List&lt;ApduRequest&gt;)</text><polygon fill="#A80036" points="1211.4,1351.5188,1223.4,1356.3188,1211.4,1361.1187,1216.2,1356.3188" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="1356.3188" y2="1356.3188"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="1060.2" y="1350.491">DigestInit</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1392.7406" y2="1387.9406"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1392.7406" y2="1397.5406"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="1392.7406" y2="1392.7406"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="1072.2" y="1386.9129">ack</text><path d="M981,1410.7406 L1239,1410.7406 L1239,1420.3406 L1227,1432.3406 L981,1432.3406 L981,1410.7406 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="167.7094" style="stroke: #000000; stroke-width: 2.4;" width="277.8" x="981" y="1410.7406"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="204" x="999" y="1428.1348">'2 * y' session MAC updates</text><polygon fill="#A80036" points="1211.4,1454.7844,1223.4,1459.5844,1211.4,1464.3844,1216.2,1459.5844" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="1459.5844" y2="1459.5844"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="1060.2" y="1453.7566">DigestUpdate</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1496.0063" y2="1491.2063"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1496.0063" y2="1500.8062"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="1496.0063" y2="1496.0063"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="1072.2" y="1490.1785">ack</text><polygon fill="#A80036" points="1211.4,1527.6281,1223.4,1532.4281,1211.4,1537.2281,1216.2,1532.4281" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="1532.4281" y2="1532.4281"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="1060.2" y="1526.6004">DigestUpdate</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1568.85" y2="1564.05"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1568.85" y2="1573.65"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="1568.85" y2="1568.85"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="1072.2" y="1563.0223">ack</text><path d="M981,1595.25 L1239,1595.25 L1239,1604.85 L1227,1616.85 L981,1616.85 L981,1595.25 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="167.7094" style="stroke: #000000; stroke-width: 2.4;" width="277.8" x="981" y="1595.25"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="204" x="999" y="1612.6441">'2 * z' session MAC updates</text><polygon fill="#A80036" points="1211.4,1639.2938,1223.4,1644.0938,1211.4,1648.8938,1216.2,1644.0938" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="1644.0938" y2="1644.0938"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="1060.2" y="1638.266">DigestUpdate</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1680.5156" y2="1675.7156"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1680.5156" y2="1685.3156"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="1680.5156" y2="1680.5156"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="1072.2" y="1674.6879">ack</text><polygon fill="#A80036" points="1211.4,1712.1375,1223.4,1716.9375,1211.4,1721.7375,1216.2,1716.9375" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="1716.9375" y2="1716.9375"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="1060.2" y="1711.1098">DigestUpdate</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1753.3594" y2="1748.5594"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1753.3594" y2="1758.1594"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="1753.3594" y2="1753.3594"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="1072.2" y="1747.5316">ack</text><polygon fill="#A80036" points="1211.4,1793.3813,1223.4,1798.1812,1211.4,1802.9813,1216.2,1798.1812" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="1798.1812" y2="1798.1812"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="84" x="1060.2" y="1792.3535">DigestClose</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1834.6031" y2="1829.8031"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="1834.6031" y2="1839.4031"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="1834.6031" y2="1834.6031"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="106.8" x="1072.2" y="1828.7754">CSM certificate</text><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="701.4" y1="1871.025" y2="1866.225"/><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="701.4" y1="1871.025" y2="1875.825"/><line style="stroke: #00FF00; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="689.4" x2="1050.6" y1="1871.025" y2="1871.025"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="106.8" x="709.8" y="1865.1973">CSM certificate</text><polygon fill="#0000FF" points="208.8,1922.2688,196.8,1927.0688,208.8,1931.8687,204,1927.0688" style="stroke: #0000FF; stroke-width: 1.2;"/><line style="stroke: #0000FF; stroke-width: 1.2;" x1="201.6" x2="688.2" y1="1927.0688" y2="1927.0688"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="157.2" x="216" y="1901.6191">PO 3: SeRequest(AID,</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="126" x="216" y="1921.241">List&lt;PoRequest&gt;)</text><path d="M15.6,1945.0688 L310.8,1945.0688 L310.8,1954.6687 L298.8,1966.6687 L15.6,1966.6687 L15.6,1945.0688 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="94.8656" style="stroke: #000000; stroke-width: 2.4;" width="301.2" x="15.6" y="1945.0688"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241.2" x="33.6" y="1962.4629">'z' PO commands inside session</text><polygon fill="#A80036" points="58.8,1989.1125,46.8,1993.9125,58.8,1998.7125,54,1993.9125" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="51.6" x2="194.4" y1="1993.9125" y2="1993.9125"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="66" y="1988.0848">ApduRequest</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="2030.3344" y2="2025.5344"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="2030.3344" y2="2035.1344"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="45.6" x2="194.4" y1="2030.3344" y2="2030.3344"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="54" y="2024.5066">ApduResponse</text><polygon fill="#A80036" points="58.8,2070.3563,46.8,2075.1563,58.8,2079.9562,54,2075.1563" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="51.6" x2="194.4" y1="2075.1563" y2="2075.1563"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="96" x="66" y="2069.3285">CloseSession</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="2111.5781" y2="2106.7781"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="2111.5781" y2="2116.3781"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="45.6" x2="194.4" y1="2111.5781" y2="2111.5781"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="94.8" x="54" y="2105.7504">PO certificate</text><polygon fill="#A80036" points="58.8,2143.2,46.8,2148,58.8,2152.8,54,2148" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="51.6" x2="194.4" y1="2148" y2="2148"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="66" y="2142.1723">Ratification</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="2184.4219" y2="2179.6219"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="193.2" x2="181.2" y1="2184.4219" y2="2189.2219"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="45.6" x2="194.4" y1="2184.4219" y2="2184.4219"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="25.2" x="54" y="2178.5941">ack</text><polygon fill="#0000FF" points="675,2216.0438,687,2220.8438,675,2225.6437,679.8,2220.8438" style="stroke: #0000FF; stroke-width: 1.2;"/><line style="stroke: #0000FF; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="195.6" x2="682.2" y1="2220.8438" y2="2220.8438"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="282" x="204" y="2215.016">SeResponse(FCI, List&lt;ApduResponse&gt;)</text><polygon fill="#00FF00" points="1037.4,2252.4656,1049.4,2257.2656,1037.4,2262.0656,1042.2,2257.2656" style="stroke: #00FF00; stroke-width: 1.2;"/><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="1044.6" y1="2257.2656" y2="2257.2656"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="333.6" x="697.8" y="2251.4379">CSM 3: SeRequest(noAID, List&lt;ApduRequest&gt;)</text><polygon fill="#A80036" points="1211.4,2288.8875,1223.4,2293.6875,1211.4,2298.4875,1216.2,2293.6875" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1218.6" y1="2293.6875" y2="2293.6875"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="1060.2" y="2287.8598">ExternalAuthenticate</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="2330.1094" y2="2325.3094"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1051.8" x2="1063.8" y1="2330.1094" y2="2334.9094"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1051.8" x2="1224.6" y1="2330.1094" y2="2330.1094"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="1072.2" y="2324.2816">authentication status</text><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="701.4" y1="2366.5313" y2="2361.7313"/><line style="stroke: #00FF00; stroke-width: 1.2;" x1="689.4" x2="701.4" y1="2366.5313" y2="2371.3312"/><line style="stroke: #00FF00; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="689.4" x2="1050.6" y1="2366.5313" y2="2366.5313"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="154.8" x="709.8" y="2360.7035">Authentification status</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="324.6" y1="2402.9531" y2="2398.1531"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="312.6" x2="324.6" y1="2402.9531" y2="2407.7531"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="312.6" x2="688.2" y1="2402.9531" y2="2402.9531"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="292.8" x="333" y="2397.1254">SessionState_Closed, List&lt;PoResponse&gt;</text><!--MD5=[f539b8e5d251ca1ca3d8a3bbd7cad4bb]
@startuml
hide footbox

actor PO
participant "PO Reader" as POR
participant "Ticketing\napplication" as TA
participant "Calypso\nTerminal API" as KC
participant "SAM Reader" as SMR
actor SAM as SM

== PO Identification ==

TA->KC: transmit(SeRequest(AID,\nList<PoRequestOutSession>))
POR<[#0000FF]-KC: PO 1: SeRequest(AID, List<ApduRequest>)
PO<-POR: SelectApplication
PO- ->>POR: PO serial
group 'x' PO commands outside session
PO<-POR: ApduRequest
PO- ->>POR: ApduResponse
end
POR- -[#0000FF]>KC: SeResponse(FCI, List<ApduResponse>)
TA<- -KC: SeResponse(PO_FCI, List<PoResponse>))

== PO Secure Session ==

TA->KC: **processOpening**(PO_FCI, OpenSessionRequest,\nList<PoRequestInSession>)
KC-[#00FF00]>SMR: CSM 1: SeRequest(noAID,\nList<ApduRequest>)
SMR->SM: SelectDiversifier
SMR<<- -SM: ack
SMR->SM: GetChallenge
SMR<<- -SM: CSM challenge
KC<<[#00FF00]- -SMR: SeResponse(FCI, List<ApduResponse>)
TA<<- -KC: SessionStatus_Identified
POR<[#0000FF]-KC: PO 2: SeRequest(AID, List<ApduRequest>)
PO<-POR: OpenSession
PO- ->>POR: PO challenge
group 'y' PO commands inside session
PO<-POR: ApduRequest
PO- ->>POR: ApduResponse
end
POR- -[#0000FF]>KC: SeResponse(FCI, List<ApduResponse>)

TA<<- -KC: SessionState_Open, List<PoResponse>

TA->KC: **processClosing**(List<PoRequestInSession>,\nList<AnticipatedPoResponse>,\nPoRatificationCommand)

KC-[#00FF00]>SMR: CSM 2: SeRequest(noAID,\nList<ApduRequest>)
SMR->SM: DigestInit
SMR<<- -SM:ack
group '2 * y' session MAC updates
SMR->SM: DigestUpdate
SMR<<- -SM: ack
SMR->SM: DigestUpdate
SMR<<- -SM: ack
end
group '2 * z' session MAC updates
SMR->SM: DigestUpdate
SMR<<- -SM: ack
SMR->SM: DigestUpdate
SMR<<- -SM: ack
end
SMR->SM: DigestClose
SMR<<- -SM: CSM certificate
KC<<[#00FF00]- -SMR: CSM certificate
POR<[#0000FF]-KC: PO 3: SeRequest(AID,\nList<PoRequest>)
group 'z' PO commands inside session
PO<-POR: ApduRequest
PO- ->>POR: ApduResponse
end
PO<-POR: CloseSession
PO- ->>POR: PO certificate
PO<-POR: Ratification
PO- ->>POR: ack
POR- -[#0000FF]>KC: SeResponse(FCI, List<ApduResponse>)
KC-[#00FF00]>SMR: CSM 3: SeRequest(noAID, List<ApduRequest>)
SMR->SM: ExternalAuthenticate
SMR<<- -SM: authentication status
KC<<[#00FF00]- -SMR: Authentification status
TA<<- -KC: SessionState_Closed, List<PoResponse>
@enduml

PlantUML version 1.2020.09(Sun May 10 14:51:06 MUT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-b765.64
Operating System: Windows 10
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>