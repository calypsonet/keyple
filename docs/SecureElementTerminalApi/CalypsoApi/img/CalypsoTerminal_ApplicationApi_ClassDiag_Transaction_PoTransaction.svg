<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2486px" preserveAspectRatio="none" style="width:1160px;height:2486px;" version="1.1" viewBox="0 0 1160 2486" width="1160px" zoomAndPan="magnify"><defs/><g><!--MD5=[858307e347215d8034d295bce1f15f07]
class SelectFileControl--><rect fill="#FEFECE" height="89.5078" id="SelectFileControl" style="stroke: #D4AC0D; stroke-width: 1.5;" width="137" x="840.5" y="2386"/><ellipse cx="855.5" cy="2402" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M854,2403 L854,2405 L858,2405 L858,2404 L858,2403.5156 L858.625,2403 L859,2403 L859.375,2403 L860,2403.5156 L860,2404 L860,2407 L852,2407 L851.5156,2407 L851,2406.375 L851,2406 L851,2405.625 L851.5156,2405 L852,2405 L852,2405 L852,2399 L852,2399 L851.5156,2399 L851,2398.375 L851,2398 L851,2397.625 L851.5156,2397 L852,2397 L860,2397 L860,2400 L860,2400.4844 L859.375,2401 L859,2401 L858.625,2401 L858,2400.4844 L858,2400 L858,2399 L854,2399 L854,2401 L855,2401 L855,2400.5156 L855,2400.5156 L855.625,2400 L856,2400 L856.375,2400 L857,2400.5156 L857,2401 L857,2403 L857,2403.4844 L856.375,2404 L856.375,2404 L856,2404 L855.625,2404 L855,2403.4844 L855,2403.4844 L855,2403 L854,2403 Z "/><ellipse cx="874.5" cy="2401.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="880.5" y="2406.9102">SelectFileControl</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="841.5" x2="976.5" y1="2418" y2="2418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="846.5" y="2433.4189">FIRST_EF,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="846.5" y="2447.2549">NEXT_EF,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="846.5" y="2461.0908">CURRENT_DF</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="841.5" x2="976.5" y1="2467.5078" y2="2467.5078"/><!--MD5=[ee0d3336d8d2c9dd88a5ad188defe636]
class ChannelControl--><rect fill="#FEFECE" height="75.6719" id="ChannelControl" style="stroke: #D4AC0D; stroke-width: 1.5;" width="130" x="1013" y="2393"/><ellipse cx="1028" cy="2409" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M1026.5,2410 L1026.5,2412 L1030.5,2412 L1030.5,2411 L1030.5,2410.5156 L1031.125,2410 L1031.5,2410 L1031.875,2410 L1032.5,2410.5156 L1032.5,2411 L1032.5,2414 L1024.5,2414 L1024.0156,2414 L1023.5,2413.375 L1023.5,2413 L1023.5,2412.625 L1024.0156,2412 L1024.5,2412 L1024.5,2412 L1024.5,2406 L1024.5,2406 L1024.0156,2406 L1023.5,2405.375 L1023.5,2405 L1023.5,2404.625 L1024.0156,2404 L1024.5,2404 L1032.5,2404 L1032.5,2407 L1032.5,2407.4844 L1031.875,2408 L1031.5,2408 L1031.125,2408 L1030.5,2407.4844 L1030.5,2407 L1030.5,2406 L1026.5,2406 L1026.5,2408 L1027.5,2408 L1027.5,2407.5156 L1027.5,2407.5156 L1028.125,2407 L1028.5,2407 L1028.875,2407 L1029.5,2407.5156 L1029.5,2408 L1029.5,2410 L1029.5,2410.4844 L1028.875,2411 L1028.875,2411 L1028.5,2411 L1028.125,2411 L1027.5,2410.4844 L1027.5,2410.4844 L1027.5,2410 L1026.5,2410 Z "/><ellipse cx="1047" cy="2408.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="1053" y="2413.9102">ChannelControl</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="1014" x2="1142" y1="2425" y2="2425"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="1019" y="2440.4189">KEEP_OPEN</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="1019" y="2454.2549">CLOSE_AFTER</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="1014" x2="1142" y1="2460.6719" y2="2460.6719"/><!--MD5=[4ea882bf7bd4263b7e27aeb216026ca4]
class PoSecuritySettingBuilder--><rect fill="#FEFECE" height="297.0469" id="PoSecuritySettingBuilder" style="stroke: #D4AC0D; stroke-width: 1.5;" width="492" x="188" y="64"/><ellipse cx="327.25" cy="80" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M329.25,76.5 Q329.4531,76 329.6875,75.75 Q329.9219,75.5 330.1875,75.5 Q330.6563,75.5 330.9531,75.7813 Q331.25,76.0625 331.25,76.7188 L331.25,78.2813 Q331.25,78.9375 330.9688,79.2188 Q330.6875,79.5 330.25,79.5 Q329.8594,79.5 329.6094,79.3281 Q329.3594,79.1563 329.25,78.7031 Q329.2031,78.3906 329.0313,78.2188 Q328.7188,77.8906 328.1563,77.7031 Q327.5938,77.5 327.0313,77.5 Q326.3281,77.5 325.7344,77.7813 Q325.1563,78.0625 324.7031,78.6875 Q324.25,79.3125 324.25,80.1719 L324.25,81.0938 Q324.25,82.125 325.0938,82.8125 Q325.9375,83.5 327.4375,83.5 Q328.3281,83.5 328.9531,83.2969 Q329.3125,83.1875 329.7188,82.8281 Q329.9844,82.625 330.125,82.5625 Q330.2656,82.5 330.4375,82.5 Q330.7656,82.5 331,82.7656 Q331.25,83.0156 331.25,83.375 Q331.25,83.7188 330.9063,84.125 Q330.4063,84.7188 329.6094,85.0469 Q328.5625,85.5 327.2813,85.5 Q325.7813,85.5 324.5781,84.9063 Q323.6094,84.4375 322.9219,83.4219 Q322.25,82.4063 322.25,81.2031 L322.25,80.1094 Q322.25,78.8594 322.8438,77.7656 Q323.4531,76.6719 324.5,76.0938 Q325.5625,75.5 326.75,75.5 Q327.4688,75.5 328.0938,75.75 Q328.7188,76 329.25,76.5 Z "/><ellipse cx="352.75" cy="79.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="358.75" y="84.9102">static</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="390.75" y="84.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="135" x="417.75" y="84.9102">PoSecuritySettingBuilder</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="189" x2="679" y1="96" y2="96"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="196" y="104"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="208" y="111.4189">final SamResource samResource</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="196" y="117.8359"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="208" y="125.2549">List&lt;Byte&gt; authorizedKvcList</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="196" y="131.6719"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="208" y="139.0908">final EnumMap&lt;AccessLevel, Byte&gt; defaultKif</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="196" y="145.5078"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="228" x="208" y="152.9268">final EnumMap&lt;AccessLevel, Byte&gt; defaultKvc</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="196" y="159.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="208" y="166.7627">final EnumMap&lt;AccessLevel, Byte&gt; defaultKeyRecordNumber</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="258" x="208" y="180.5986">ModificationMode sessionModificationMode = ATOMIC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="254" x="208" y="194.4346">RatificationMode ratificationMode = CLOSE_RATIFIED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="189" x2="679" y1="200.8516" y2="200.8516"/><ellipse cx="199" cy="211.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="270" x="208" y="216.2705">PoSecuritySettingsBuilder(SamResource samResource)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="211" y="230.1064"/><ellipse cx="199" cy="239.5234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="463" x="208" y="243.9424">PoSecuritySettingsBuilder sessionModificationMode(ModificationMode sessionModificationMode)</text><ellipse cx="199" cy="253.3594" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="369" x="208" y="257.7783">PoSecuritySettingsBuilder ratificationMode(RatificationMode ratificationMode)</text><ellipse cx="199" cy="267.1953" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="430" x="208" y="271.6143">PoSecuritySettingsBuilder sessionDefaultKif(AccessLevel sessionAccessLevel, byte kif)</text><ellipse cx="199" cy="281.0313" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="442" x="208" y="285.4502">PoSecuritySettingsBuilder sessionDefaultKvc(AccessLevel sessionAccessLevel, byte kvc)</text><ellipse cx="199" cy="294.8672" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="466" x="208" y="299.2861">PoSecuritySettingsBuilder sessionDefaultKeyRecordNumber(AccessLevel sessionAccessLevel,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="208" y="313.1221">byte keyRecordNumber)</text><ellipse cx="199" cy="322.5391" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="403" x="208" y="326.958">PoSecuritySettingsBuilder sessionAuthorizedKvcList(List&lt;Byte&gt; authorizedKvcList)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="211" y="340.7939"/><ellipse cx="199" cy="350.2109" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="208" y="354.6299">PoSecuritySettings build()</text><path d="M715.5,158.5 L715.5,208.5 L680.082,212.5 L715.5,216.5 L715.5,266.6094 A0,0 0 0 0 715.5,266.6094 L1148.5,266.6094 A0,0 0 0 0 1148.5,266.6094 L1148.5,168.5 L1138.5,158.5 L715.5,158.5 A0,0 0 0 0 715.5,158.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1138.5,158.5 L1138.5,168.5 L1148.5,168.5 L1138.5,158.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="405" x="721.5" y="176.9951">Default values in PoTransaction if PoSecuritySetting doesn't specify it:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="729.5" y="193.3467">- session ModificationMode as ATOMIC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="729.5" y="209.6982">- session RatificationMode as CLOSE_RATIFIED</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="360" x="729.5" y="226.0498">- PinTransmissionMode as ENCRYPTED if PoSecurity defined</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="729.5" y="242.4014">- any KIF/KVC values are authorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="404" x="729.5" y="258.7529">- no verification is done for: HCE token expiration, revoked PO or SAM</text><!--MD5=[e4d4ea7db949ad9d239210033b878e09]
class PoSecuritySetting--><rect fill="#FEFECE" height="310.8828" id="PoSecuritySetting" style="stroke: #D4AC0D; stroke-width: 1.5;" width="327" x="436.5" y="439"/><ellipse cx="528.75" cy="455" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M530.75,451.5 Q530.9531,451 531.1875,450.75 Q531.4219,450.5 531.6875,450.5 Q532.1563,450.5 532.4531,450.7813 Q532.75,451.0625 532.75,451.7188 L532.75,453.2813 Q532.75,453.9375 532.4688,454.2188 Q532.1875,454.5 531.75,454.5 Q531.3594,454.5 531.1094,454.3281 Q530.8594,454.1563 530.75,453.7031 Q530.7031,453.3906 530.5313,453.2188 Q530.2188,452.8906 529.6563,452.7031 Q529.0938,452.5 528.5313,452.5 Q527.8281,452.5 527.2344,452.7813 Q526.6563,453.0625 526.2031,453.6875 Q525.75,454.3125 525.75,455.1719 L525.75,456.0938 Q525.75,457.125 526.5938,457.8125 Q527.4375,458.5 528.9375,458.5 Q529.8281,458.5 530.4531,458.2969 Q530.8125,458.1875 531.2188,457.8281 Q531.4844,457.625 531.625,457.5625 Q531.7656,457.5 531.9375,457.5 Q532.2656,457.5 532.5,457.7656 Q532.75,458.0156 532.75,458.375 Q532.75,458.7188 532.4063,459.125 Q531.9063,459.7188 531.1094,460.0469 Q530.0625,460.5 528.7813,460.5 Q527.2813,460.5 526.0781,459.9063 Q525.1094,459.4375 524.4219,458.4219 Q523.75,457.4063 523.75,456.2031 L523.75,455.1094 Q523.75,453.8594 524.3438,452.7656 Q524.9531,451.6719 526,451.0938 Q527.0625,450.5 528.25,450.5 Q528.9688,450.5 529.5938,450.75 Q530.2188,451 530.75,451.5 Z "/><ellipse cx="554.25" cy="454.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="560.25" y="459.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="587.25" y="459.9102">PoSecuritySetting</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="437.5" x2="762.5" y1="471" y2="471"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="437.5" x2="762.5" y1="479" y2="479"/><ellipse cx="447.5" cy="490" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="456.5" y="494.4189">PoSecuritySetting(SamResource samResource);</text><polygon fill="#FFFF44" points="447.5,498.8359,451.5,502.8359,447.5,506.8359,443.5,502.8359" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="456.5" y="508.2549">PoRevokedService getPoRevokedService()</text><polygon fill="#FFFF44" points="447.5,512.6719,451.5,516.6719,447.5,520.6719,443.5,516.6719" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="226" x="456.5" y="522.0908">SamRevokedService getSamRevokedService()</text><polygon fill="#FFFF44" points="447.5,526.5078,451.5,530.5078,447.5,534.5078,443.5,530.5078" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="456.5" y="535.9268">PoHceService getPoHceService()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="549.7627"/><ellipse cx="447.5" cy="559.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="456.5" y="563.5986">loadProperties(Properties propertyFile)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="577.4346"/><polygon fill="#FFFF44" points="447.5,581.8516,451.5,585.8516,447.5,589.8516,443.5,585.8516" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="456.5" y="591.2705">ModificationMode getSessionModificationMode()</text><polygon fill="#FFFF44" points="447.5,595.6875,451.5,599.6875,447.5,603.6875,443.5,599.6875" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="456.5" y="605.1064">RatificationMode getSessionRatificationMode()</text><polygon fill="#FFFF44" points="447.5,609.5234,451.5,613.5234,447.5,617.5234,443.5,613.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="456.5" y="618.9424">Byte getSessionDefaultKif(AccessLevel level)</text><polygon fill="#FFFF44" points="447.5,623.3594,451.5,627.3594,447.5,631.3594,443.5,627.3594" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="456.5" y="632.7783">Byte getSessionDefaultKvc(AccessLevel level)</text><polygon fill="#FFFF44" points="447.5,637.1953,451.5,641.1953,447.5,645.1953,443.5,641.1953" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="301" x="456.5" y="646.6143">Byte getSessionDefaultKeyRecordNumber(AccessLevel level)</text><polygon fill="#FFFF44" points="447.5,651.0313,451.5,655.0313,447.5,659.0313,443.5,655.0313" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="456.5" y="660.4502">Boolean isSessionKvcAuthorized(byte kvc)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="674.2861"/><polygon fill="#FFFF44" points="447.5,678.7031,451.5,682.7031,447.5,686.7031,443.5,682.7031" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="456.5" y="688.1221">PinTransmissionMode getPinTransmissionMode()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="701.958"/><polygon fill="#FFFF44" points="447.5,706.375,451.5,710.375,447.5,714.375,443.5,710.375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="456.5" y="715.7939">LogRead getSvGetLogReadMode()</text><polygon fill="#FFFF44" points="447.5,720.2109,451.5,724.2109,447.5,728.2109,443.5,724.2109" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="456.5" y="729.6299">NegativeBalance getSvNegativeBalance()</text><polygon fill="#FFFF44" points="447.5,734.0469,451.5,738.0469,447.5,742.0469,443.5,738.0469" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="184" x="456.5" y="743.4658">Boolean isSvKvcAuthorized(byte kvc)</text><!--MD5=[8eb5cec01ad571a9feeff1db4f73a667]
class PoTransaction--><rect fill="#FEFECE" height="712.125" id="PoTransaction" style="stroke: #D4AC0D; stroke-width: 1.5;" width="764" x="279" y="1170"/><ellipse cx="611.25" cy="1186" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M613.25,1182.5 Q613.4531,1182 613.6875,1181.75 Q613.9219,1181.5 614.1875,1181.5 Q614.6563,1181.5 614.9531,1181.7813 Q615.25,1182.0625 615.25,1182.7188 L615.25,1184.2813 Q615.25,1184.9375 614.9688,1185.2188 Q614.6875,1185.5 614.25,1185.5 Q613.8594,1185.5 613.6094,1185.3281 Q613.3594,1185.1563 613.25,1184.7031 Q613.2031,1184.3906 613.0313,1184.2188 Q612.7188,1183.8906 612.1563,1183.7031 Q611.5938,1183.5 611.0313,1183.5 Q610.3281,1183.5 609.7344,1183.7813 Q609.1563,1184.0625 608.7031,1184.6875 Q608.25,1185.3125 608.25,1186.1719 L608.25,1187.0938 Q608.25,1188.125 609.0938,1188.8125 Q609.9375,1189.5 611.4375,1189.5 Q612.3281,1189.5 612.9531,1189.2969 Q613.3125,1189.1875 613.7188,1188.8281 Q613.9844,1188.625 614.125,1188.5625 Q614.2656,1188.5 614.4375,1188.5 Q614.7656,1188.5 615,1188.7656 Q615.25,1189.0156 615.25,1189.375 Q615.25,1189.7188 614.9063,1190.125 Q614.4063,1190.7188 613.6094,1191.0469 Q612.5625,1191.5 611.2813,1191.5 Q609.7813,1191.5 608.5781,1190.9063 Q607.6094,1190.4375 606.9219,1189.4219 Q606.25,1188.4063 606.25,1187.2031 L606.25,1186.1094 Q606.25,1184.8594 606.8438,1183.7656 Q607.4531,1182.6719 608.5,1182.0938 Q609.5625,1181.5 610.75,1181.5 Q611.4688,1181.5 612.0938,1181.75 Q612.7188,1182 613.25,1182.5 Z "/><ellipse cx="636.75" cy="1185.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="642.75" y="1190.9102">PoTransaction</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="280" x2="1042" y1="1202" y2="1202"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="280" x2="1042" y1="1210" y2="1210"/><ellipse cx="290" cy="1221" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="388" x="299" y="1225.4189">PoTransaction(PoResource poResource, PoSecuritySetting[0..1] securitySetting)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="302" y="1239.2549"/><ellipse cx="290" cy="1248.6719" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1253.0908">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="227" x="325" y="1253.0908">processPoCommands(ChannelControl channel)</text><ellipse cx="290" cy="1262.5078" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1266.9268">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="177" x="325" y="1266.9268">processOpening(AccessLevel level)</text><ellipse cx="290" cy="1276.3438" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1280.7627">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="325" y="1280.7627">processPoCommandsInSession()</text><ellipse cx="290" cy="1290.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1294.5986">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="197" x="325" y="1294.5986">processClosing(ChannelControl channel)</text><ellipse cx="290" cy="1304.0156" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1308.4346">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="325" y="1308.4346">processCancel(ChannelControl channel)</text><ellipse cx="290" cy="1317.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1322.2705">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="398" x="325" y="1322.2705">prepareManageSession(EncryptionMode encMode, AuthenticationMode authMode)</text><ellipse cx="290" cy="1331.6875" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1336.1064">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="218" x="325" y="1336.1064">SessionSecureData getSessionSecureData()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="302" y="1349.9424"/><ellipse cx="290" cy="1359.3594" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1363.7783">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="325" y="1363.7783">prepareCheckPinStatus()</text><ellipse cx="290" cy="1373.1953" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1377.6143">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="135" x="325" y="1377.6143">prepareVerifyPin(String pin)</text><ellipse cx="290" cy="1387.0313" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1391.4502">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="325" y="1391.4502">prepareVerifyPin(byte[] pin)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="302" y="1405.2861"/><ellipse cx="290" cy="1414.7031" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1419.1221">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="338" x="325" y="1419.1221">prepareSvGet(SvSetting.Operation operation, SvSetting.Action action)</text><ellipse cx="290" cy="1428.5391" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1432.958">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="278" x="325" y="1432.958">prepareSvReload(int amount, int date, int time, String free)</text><ellipse cx="290" cy="1442.375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1446.7939">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="325" y="1446.7939">prepareSvReload(int amount, byte[] date, byte[] time, byte[] free)</text><ellipse cx="290" cy="1456.2109" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1460.6299">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="325" y="1460.6299">prepareSvReload(int amount)</text><ellipse cx="290" cy="1470.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1474.4658">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="325" y="1474.4658">prepareSvDebit(int amount, int date, int time)</text><ellipse cx="290" cy="1483.8828" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1488.3018">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="244" x="325" y="1488.3018">prepareSvDebit(int amount, byte[] date, byte[] time)</text><ellipse cx="290" cy="1497.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1502.1377">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="325" y="1502.1377">prepareSvDebit(int amount)</text><ellipse cx="290" cy="1511.5547" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1515.9736">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="260" x="325" y="1515.9736">SvOperationSecureData getSvOperationSecureData()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="302" y="1529.8096"/><ellipse cx="290" cy="1539.2266" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1543.6455">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="325" y="1543.6455">prepareSelectFile(short lid)</text><ellipse cx="290" cy="1553.0625" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1557.4814">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="325" y="1557.4814">prepareSelectFile(byte[] lid)</text><ellipse cx="290" cy="1566.8984" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1571.3174">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="325" y="1571.3174">prepareSelectFile(SelectFileControl control)</text><ellipse cx="290" cy="1580.7344" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1585.1533">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="325" y="1585.1533">prepareReadRecordFile(byte sfi, int recordNumber)</text><ellipse cx="290" cy="1594.5703" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1598.9893">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="455" x="325" y="1598.9893">prepareReadRecordFile(byte sfi, int firstRecordNumber, int numberOfRecords, int recordSize))</text><ellipse cx="290" cy="1608.4063" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1612.8252">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="559" x="325" y="1612.8252">prepareReadSubRecordFile(byte sfi, int firstRecordNumber, int numberOfRecord, int recordOffset, int recordLength)</text><ellipse cx="290" cy="1622.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1626.6611">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="324" x="325" y="1626.6611">prepareReadBinaryFile(byte sfi, int dataLength, int[0..1] dataOffset)</text><ellipse cx="290" cy="1636.0781" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1640.4971">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="325" y="1640.4971">prepareReadCounterFile(byte sfi, int countersNumber)</text><ellipse cx="290" cy="1649.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1654.333">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="325" y="1654.333">prepareAppendRecord(byte sfi, byte[] recordData)</text><ellipse cx="290" cy="1663.75" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1668.1689">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="330" x="325" y="1668.1689">prepareUpdateRecord(byte sfi, int recordNumber, byte[] recordData)</text><ellipse cx="290" cy="1677.5859" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1682.0049">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="321" x="325" y="1682.0049">prepareWriteRecord(byte sfi, int recordNumber, byte[] recordData)</text><ellipse cx="290" cy="1691.4219" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1695.8408">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="331" x="325" y="1695.8408">prepareUpdateBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)</text><ellipse cx="290" cy="1705.2578" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1709.6768">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="322" x="325" y="1709.6768">prepareWriteBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)</text><ellipse cx="290" cy="1719.0938" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1723.5127">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="318" x="325" y="1723.5127">prepareIncreaseCounter(byte sfi, int counterNumber, int incValue)</text><ellipse cx="290" cy="1732.9297" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1737.3486">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="327" x="325" y="1737.3486">prepareDecreaseCounter(byte sfi, int counterNumber, int decValue)</text><ellipse cx="290" cy="1746.7656" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1751.1846">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="325" y="1751.1846">prepareSetCounter(byte sfi, int counterNumber, int newValue)</text><ellipse cx="290" cy="1760.6016" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1765.0205">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="712" x="325" y="1765.0205">int prepareSearchRecord(byte sfi, byte offset, SearchOffsetMode offsetMode, byte[] searchData, Byte[] searchMask, SearchReadMode readMode)</text><ellipse cx="290" cy="1774.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1778.8564">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="233" x="325" y="1778.8564">int[] getSearchResult(int searchRequestNumber)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="302" y="1792.6924"/><ellipse cx="290" cy="1802.1094" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1806.5283">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="325" y="1806.5283">prepareInvalidate()</text><ellipse cx="290" cy="1815.9453" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1820.3643">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="325" y="1820.3643">prepareRehabilitate()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="302" y="1834.2002"/><ellipse cx="290" cy="1843.6172" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1848.0361">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="325" y="1848.0361">prepareChangeKey(AccessLevel level)</text><ellipse cx="290" cy="1857.4531" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1861.8721">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="142" x="325" y="1861.8721">prepareChangePin(String pin)</text><ellipse cx="290" cy="1871.2891" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="299" y="1875.708">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="325" y="1875.708">prepareChangePin(byte[] pin)</text><!--MD5=[2242c43c330acc437358859ea7f59776]
class SessionState--><rect fill="#FEFECE" height="89.5078" id="SessionState" style="stroke: #D4AC0D; stroke-width: 1.5;" width="125" x="459.5" y="1943"/><ellipse cx="478.1" cy="1959" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M476.6,1960 L476.6,1962 L480.6,1962 L480.6,1961 L480.6,1960.5156 L481.225,1960 L481.6,1960 L481.975,1960 L482.6,1960.5156 L482.6,1961 L482.6,1964 L474.6,1964 L474.1156,1964 L473.6,1963.375 L473.6,1963 L473.6,1962.625 L474.1156,1962 L474.6,1962 L474.6,1962 L474.6,1956 L474.6,1956 L474.1156,1956 L473.6,1955.375 L473.6,1955 L473.6,1954.625 L474.1156,1954 L474.6,1954 L482.6,1954 L482.6,1957 L482.6,1957.4844 L481.975,1958 L481.6,1958 L481.225,1958 L480.6,1957.4844 L480.6,1957 L480.6,1956 L476.6,1956 L476.6,1958 L477.6,1958 L477.6,1957.5156 L477.6,1957.5156 L478.225,1957 L478.6,1957 L478.975,1957 L479.6,1957.5156 L479.6,1958 L479.6,1960 L479.6,1960.4844 L478.975,1961 L478.975,1961 L478.6,1961 L478.225,1961 L477.6,1960.4844 L477.6,1960.4844 L477.6,1960 L476.6,1960 Z "/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="494.9" y="1955.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="503.9" y="1963.9102">SessionState</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460.5" x2="583.5" y1="1975" y2="1975"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="465.5" y="1990.4189">SESSION_UNITIALIZED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="465.5" y="2004.2549">SESSION_OPEN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="465.5" y="2018.0908">SESSION_CLOSED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460.5" x2="583.5" y1="2024.5078" y2="2024.5078"/><!--MD5=[bf7a0c1c8b34ad25b46528e084cfcf9f]
class SessionSetting--><rect fill="#FEFECE" height="48" id="SessionSetting" style="stroke: #D4AC0D; stroke-width: 1.5;" width="154" x="620" y="1964"/><ellipse cx="635" cy="1980" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M637,1976.5 Q637.2031,1976 637.4375,1975.75 Q637.6719,1975.5 637.9375,1975.5 Q638.4063,1975.5 638.7031,1975.7813 Q639,1976.0625 639,1976.7188 L639,1978.2813 Q639,1978.9375 638.7188,1979.2188 Q638.4375,1979.5 638,1979.5 Q637.6094,1979.5 637.3594,1979.3281 Q637.1094,1979.1563 637,1978.7031 Q636.9531,1978.3906 636.7813,1978.2188 Q636.4688,1977.8906 635.9063,1977.7031 Q635.3438,1977.5 634.7813,1977.5 Q634.0781,1977.5 633.4844,1977.7813 Q632.9063,1978.0625 632.4531,1978.6875 Q632,1979.3125 632,1980.1719 L632,1981.0938 Q632,1982.125 632.8438,1982.8125 Q633.6875,1983.5 635.1875,1983.5 Q636.0781,1983.5 636.7031,1983.2969 Q637.0625,1983.1875 637.4688,1982.8281 Q637.7344,1982.625 637.875,1982.5625 Q638.0156,1982.5 638.1875,1982.5 Q638.5156,1982.5 638.75,1982.7656 Q639,1983.0156 639,1983.375 Q639,1983.7188 638.6563,1984.125 Q638.1563,1984.7188 637.3594,1985.0469 Q636.3125,1985.5 635.0313,1985.5 Q633.5313,1985.5 632.3281,1984.9063 Q631.3594,1984.4375 630.6719,1983.4219 Q630,1982.4063 630,1981.2031 L630,1980.1094 Q630,1978.8594 630.5938,1977.7656 Q631.2031,1976.6719 632.25,1976.0938 Q633.3125,1975.5 634.5,1975.5 Q635.2188,1975.5 635.8438,1975.75 Q636.4688,1976 637,1976.5 Z "/><ellipse cx="654" cy="1979.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="660" y="1984.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="687" y="1984.9102">SessionSetting</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="621" x2="773" y1="1996" y2="1996"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="621" x2="773" y1="2004" y2="2004"/><!--MD5=[45c40070d26b32101cf9b7ab72916b9e]
class AccessLevel--><rect fill="#FEFECE" height="89.5078" id="AccessLevel" style="stroke: #D4AC0D; stroke-width: 1.5;" width="223" x="723.5" y="2233"/><ellipse cx="790.75" cy="2249" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M789.25,2250 L789.25,2252 L793.25,2252 L793.25,2251 L793.25,2250.5156 L793.875,2250 L794.25,2250 L794.625,2250 L795.25,2250.5156 L795.25,2251 L795.25,2254 L787.25,2254 L786.7656,2254 L786.25,2253.375 L786.25,2253 L786.25,2252.625 L786.7656,2252 L787.25,2252 L787.25,2252 L787.25,2246 L787.25,2246 L786.7656,2246 L786.25,2245.375 L786.25,2245 L786.25,2244.625 L786.7656,2244 L787.25,2244 L795.25,2244 L795.25,2247 L795.25,2247.4844 L794.625,2248 L794.25,2248 L793.875,2248 L793.25,2247.4844 L793.25,2247 L793.25,2246 L789.25,2246 L789.25,2248 L790.25,2248 L790.25,2247.5156 L790.25,2247.5156 L790.875,2247 L791.25,2247 L791.625,2247 L792.25,2247.5156 L792.25,2248 L792.25,2250 L792.25,2250.4844 L791.625,2251 L791.625,2251 L791.25,2251 L790.875,2251 L790.25,2250.4844 L790.25,2250.4844 L790.25,2250 L789.25,2250 Z "/><ellipse cx="816.25" cy="2248.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="822.25" y="2253.9102">AccessLevel</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="724.5" x2="945.5" y1="2265" y2="2265"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="724.5" x2="945.5" y1="2273" y2="2273"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="729.5" y="2288.4189">SESSION_LVL_PERSO("perso", byte 0x01),</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="729.5" y="2302.2549">SESSION_LVL_LOAD("load", byte 0x02),</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="197" x="729.5" y="2316.0908">SESSION_LVL_DEBIT("debit", byte 0x03)</text><!--MD5=[e19a48d2c11a8f9a6a11f4ef9a7d8d18]
class ModificationMode--><rect fill="#FEFECE" height="75.6719" id="ModificationMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="138" x="459" y="2094"/><ellipse cx="474" cy="2110" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M472.5,2111 L472.5,2113 L476.5,2113 L476.5,2112 L476.5,2111.5156 L477.125,2111 L477.5,2111 L477.875,2111 L478.5,2111.5156 L478.5,2112 L478.5,2115 L470.5,2115 L470.0156,2115 L469.5,2114.375 L469.5,2114 L469.5,2113.625 L470.0156,2113 L470.5,2113 L470.5,2113 L470.5,2107 L470.5,2107 L470.0156,2107 L469.5,2106.375 L469.5,2106 L469.5,2105.625 L470.0156,2105 L470.5,2105 L478.5,2105 L478.5,2108 L478.5,2108.4844 L477.875,2109 L477.5,2109 L477.125,2109 L476.5,2108.4844 L476.5,2108 L476.5,2107 L472.5,2107 L472.5,2109 L473.5,2109 L473.5,2108.5156 L473.5,2108.5156 L474.125,2108 L474.5,2108 L474.875,2108 L475.5,2108.5156 L475.5,2109 L475.5,2111 L475.5,2111.4844 L474.875,2112 L474.875,2112 L474.5,2112 L474.125,2112 L473.5,2111.4844 L473.5,2111.4844 L473.5,2111 L472.5,2111 Z "/><ellipse cx="493" cy="2109.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="499" y="2114.9102">ModificationMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460" x2="596" y1="2126" y2="2126"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="465" y="2141.4189">ATOMIC,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="465" y="2155.2549">MULTIPLE</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460" x2="596" y1="2161.6719" y2="2161.6719"/><!--MD5=[139c679d0f2db6318e7e57d2f6dd7d7b]
class RatificationMode--><rect fill="#FEFECE" height="75.6719" id="RatificationMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="134" x="871" y="2094"/><ellipse cx="886" cy="2110" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M884.5,2111 L884.5,2113 L888.5,2113 L888.5,2112 L888.5,2111.5156 L889.125,2111 L889.5,2111 L889.875,2111 L890.5,2111.5156 L890.5,2112 L890.5,2115 L882.5,2115 L882.0156,2115 L881.5,2114.375 L881.5,2114 L881.5,2113.625 L882.0156,2113 L882.5,2113 L882.5,2113 L882.5,2107 L882.5,2107 L882.0156,2107 L881.5,2106.375 L881.5,2106 L881.5,2105.625 L882.0156,2105 L882.5,2105 L890.5,2105 L890.5,2108 L890.5,2108.4844 L889.875,2109 L889.5,2109 L889.125,2109 L888.5,2108.4844 L888.5,2108 L888.5,2107 L884.5,2107 L884.5,2109 L885.5,2109 L885.5,2108.5156 L885.5,2108.5156 L886.125,2108 L886.5,2108 L886.875,2108 L887.5,2108.5156 L887.5,2109 L887.5,2111 L887.5,2111.4844 L886.875,2112 L886.875,2112 L886.5,2112 L886.125,2112 L885.5,2111.4844 L885.5,2111.4844 L885.5,2111 L884.5,2111 Z "/><ellipse cx="905" cy="2109.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="911" y="2114.9102">RatificationMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="872" x2="1004" y1="2126" y2="2126"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="877" y="2141.4189">CLOSE_RATIFIED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="877" y="2155.2549">CLOSE_NOT_RATIFIED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="872" x2="1004" y1="2161.6719" y2="2161.6719"/><!--MD5=[ce8182edd4590e04a2102797ac389b3e]
class EncryptionMode--><rect fill="#FEFECE" height="75.6719" id="EncryptionMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="130" x="669" y="2094"/><ellipse cx="684" cy="2110" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M682.5,2111 L682.5,2113 L686.5,2113 L686.5,2112 L686.5,2111.5156 L687.125,2111 L687.5,2111 L687.875,2111 L688.5,2111.5156 L688.5,2112 L688.5,2115 L680.5,2115 L680.0156,2115 L679.5,2114.375 L679.5,2114 L679.5,2113.625 L680.0156,2113 L680.5,2113 L680.5,2113 L680.5,2107 L680.5,2107 L680.0156,2107 L679.5,2106.375 L679.5,2106 L679.5,2105.625 L680.0156,2105 L680.5,2105 L688.5,2105 L688.5,2108 L688.5,2108.4844 L687.875,2109 L687.5,2109 L687.125,2109 L686.5,2108.4844 L686.5,2108 L686.5,2107 L682.5,2107 L682.5,2109 L683.5,2109 L683.5,2108.5156 L683.5,2108.5156 L684.125,2108 L684.5,2108 L684.875,2108 L685.5,2108.5156 L685.5,2109 L685.5,2111 L685.5,2111.4844 L684.875,2112 L684.875,2112 L684.5,2112 L684.125,2112 L683.5,2111.4844 L683.5,2111.4844 L683.5,2111 L682.5,2111 Z "/><ellipse cx="703" cy="2109.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="709" y="2114.9102">EncryptionMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="670" x2="798" y1="2126" y2="2126"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="54" x="675" y="2141.4189">ACTIVATE,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="675" y="2155.2549">DEACTIVATE</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="670" x2="798" y1="2161.6719" y2="2161.6719"/><!--MD5=[587c29523c7e651cb28d7191d1daa746]
class AuthenticationMode--><rect fill="#FEFECE" height="75.6719" id="AuthenticationMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="150" x="538" y="2240"/><ellipse cx="553" cy="2256" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M551.5,2257 L551.5,2259 L555.5,2259 L555.5,2258 L555.5,2257.5156 L556.125,2257 L556.5,2257 L556.875,2257 L557.5,2257.5156 L557.5,2258 L557.5,2261 L549.5,2261 L549.0156,2261 L548.5,2260.375 L548.5,2260 L548.5,2259.625 L549.0156,2259 L549.5,2259 L549.5,2259 L549.5,2253 L549.5,2253 L549.0156,2253 L548.5,2252.375 L548.5,2252 L548.5,2251.625 L549.0156,2251 L549.5,2251 L557.5,2251 L557.5,2254 L557.5,2254.4844 L556.875,2255 L556.5,2255 L556.125,2255 L555.5,2254.4844 L555.5,2254 L555.5,2253 L551.5,2253 L551.5,2255 L552.5,2255 L552.5,2254.5156 L552.5,2254.5156 L553.125,2254 L553.5,2254 L553.875,2254 L554.5,2254.5156 L554.5,2255 L554.5,2257 L554.5,2257.4844 L553.875,2258 L553.875,2258 L553.5,2258 L553.125,2258 L552.5,2257.4844 L552.5,2257.4844 L552.5,2257 L551.5,2257 Z "/><ellipse cx="572" cy="2255.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="107" x="578" y="2260.9102">AuthenticationMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="539" x2="687" y1="2272" y2="2272"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="544" y="2287.4189">REQUESTED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="544" y="2301.2549">NOT_REQUESTED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="539" x2="687" y1="2307.6719" y2="2307.6719"/><!--MD5=[69e7de8796175c80a787a8fe6d04a077]
class PinTransmissionMode--><rect fill="#FEFECE" height="75.6719" id="PinTransmissionMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="168" x="809" y="1950"/><ellipse cx="824" cy="1966" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M822.5,1967 L822.5,1969 L826.5,1969 L826.5,1968 L826.5,1967.5156 L827.125,1967 L827.5,1967 L827.875,1967 L828.5,1967.5156 L828.5,1968 L828.5,1971 L820.5,1971 L820.0156,1971 L819.5,1970.375 L819.5,1970 L819.5,1969.625 L820.0156,1969 L820.5,1969 L820.5,1969 L820.5,1963 L820.5,1963 L820.0156,1963 L819.5,1962.375 L819.5,1962 L819.5,1961.625 L820.0156,1961 L820.5,1961 L828.5,1961 L828.5,1964 L828.5,1964.4844 L827.875,1965 L827.5,1965 L827.125,1965 L826.5,1964.4844 L826.5,1964 L826.5,1963 L822.5,1963 L822.5,1965 L823.5,1965 L823.5,1964.5156 L823.5,1964.5156 L824.125,1964 L824.5,1964 L824.875,1964 L825.5,1964.5156 L825.5,1965 L825.5,1967 L825.5,1967.4844 L824.875,1968 L824.875,1968 L824.5,1968 L824.125,1968 L823.5,1967.4844 L823.5,1967.4844 L823.5,1967 L822.5,1967 Z "/><ellipse cx="843" cy="1965.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="125" x="849" y="1970.9102">PinTransmissionMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="810" x2="976" y1="1982" y2="1982"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="815" y="1997.4189">PLAIN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="815" y="2011.2549">ENCRYPTED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="810" x2="976" y1="2017.6719" y2="2017.6719"/><!--MD5=[80e74f8fe2d788e9d347a51040ef83af]
class SamRevokedService--><rect fill="#FEFECE" height="61.8359" id="SamRevokedService" style="stroke: #D4AC0D; stroke-width: 1.5;" width="326" x="799" y="563.5"/><ellipse cx="893.75" cy="579.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #B4A7E5; stroke-width: 1.0;"/><path d="M894.75,576.5 L894.75,582.5 L896.75,582.5 L897.2344,582.5 L897.75,583.125 L897.75,583.5 L897.75,583.875 L897.2344,584.5 L896.75,584.5 L890.75,584.5 L890.2656,584.5 L889.75,583.875 L889.75,583.5 L889.75,583.125 L890.2656,582.5 L890.75,582.5 L892.75,582.5 L892.75,576.5 L890.75,576.5 L890.2656,576.5 L889.75,575.875 L889.75,575.5 L889.75,575.125 L890.2656,574.5 L890.75,574.5 L896.75,574.5 L897.2344,574.5 L897.75,575.125 L897.75,575.5 L897.75,575.875 L897.2344,576.5 L896.75,576.5 L894.75,576.5 Z "/><ellipse cx="919.25" cy="579" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="117" x="925.25" y="584.4102">SamRevokedService</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="800" x2="1124" y1="595.5" y2="595.5"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="800" x2="1124" y1="603.5" y2="603.5"/><ellipse cx="810" cy="614.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="819" y="618.9189">isSamRevoked(byte[] 4bytesSerial, byte[][0..1] 3bytesCounter)</text><!--MD5=[43918d86839edc1befb88ea50efcfbfb]
class SamResource--><rect fill="#FEFECE" height="75.6719" id="SamResource" style="stroke: #D4AC0D; stroke-width: 1.5;" width="191" x="838.5" y="811"/><ellipse cx="855.3" cy="827" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M857.3,823.5 Q857.5031,823 857.7375,822.75 Q857.9719,822.5 858.2375,822.5 Q858.7063,822.5 859.0031,822.7813 Q859.3,823.0625 859.3,823.7188 L859.3,825.2813 Q859.3,825.9375 859.0188,826.2188 Q858.7375,826.5 858.3,826.5 Q857.9094,826.5 857.6594,826.3281 Q857.4094,826.1563 857.3,825.7031 Q857.2531,825.3906 857.0813,825.2188 Q856.7688,824.8906 856.2063,824.7031 Q855.6438,824.5 855.0813,824.5 Q854.3781,824.5 853.7844,824.7813 Q853.2063,825.0625 852.7531,825.6875 Q852.3,826.3125 852.3,827.1719 L852.3,828.0938 Q852.3,829.125 853.1438,829.8125 Q853.9875,830.5 855.4875,830.5 Q856.3781,830.5 857.0031,830.2969 Q857.3625,830.1875 857.7688,829.8281 Q858.0344,829.625 858.175,829.5625 Q858.3156,829.5 858.4875,829.5 Q858.8156,829.5 859.05,829.7656 Q859.3,830.0156 859.3,830.375 Q859.3,830.7188 858.9563,831.125 Q858.4563,831.7188 857.6594,832.0469 Q856.6125,832.5 855.3313,832.5 Q853.8313,832.5 852.6281,831.9063 Q851.6594,831.4375 850.9719,830.4219 Q850.3,829.4063 850.3,828.2031 L850.3,827.1094 Q850.3,825.8594 850.8938,824.7656 Q851.5031,823.6719 852.55,823.0938 Q853.6125,822.5 854.8,822.5 Q855.5188,822.5 856.1438,822.75 Q856.7688,823 857.3,823.5 Z "/><ellipse cx="874.7" cy="826.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="880.7" y="831.9102">SeResource</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="73" x="959.5" y="808"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="71" x="960.5" y="821.457">CalypsoSam</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="839.5" x2="1028.5" y1="843" y2="843"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="839.5" x2="1028.5" y1="851" y2="851"/><ellipse cx="849.5" cy="862" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="858.5" y="866.4189">SeResource(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="922.5" y="866.4189">SeReader seReader</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="3" x="1020.5" y="866.4189">,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="858.5" y="880.2549">CalypsoSam sam);</text><!--MD5=[f25ff1fa8fa59bbc0543eaadeb7d653a]
class CalypsoSam--><rect fill="#FEFECE" height="158.6875" id="CalypsoSam" style="stroke: #D4AC0D; stroke-width: 1.5;" width="251" x="808.5" y="948"/><ellipse cx="875.25" cy="964" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M877.25,960.5 Q877.4531,960 877.6875,959.75 Q877.9219,959.5 878.1875,959.5 Q878.6563,959.5 878.9531,959.7813 Q879.25,960.0625 879.25,960.7188 L879.25,962.2813 Q879.25,962.9375 878.9688,963.2188 Q878.6875,963.5 878.25,963.5 Q877.8594,963.5 877.6094,963.3281 Q877.3594,963.1563 877.25,962.7031 Q877.2031,962.3906 877.0313,962.2188 Q876.7188,961.8906 876.1563,961.7031 Q875.5938,961.5 875.0313,961.5 Q874.3281,961.5 873.7344,961.7813 Q873.1563,962.0625 872.7031,962.6875 Q872.25,963.3125 872.25,964.1719 L872.25,965.0938 Q872.25,966.125 873.0938,966.8125 Q873.9375,967.5 875.4375,967.5 Q876.3281,967.5 876.9531,967.2969 Q877.3125,967.1875 877.7188,966.8281 Q877.9844,966.625 878.125,966.5625 Q878.2656,966.5 878.4375,966.5 Q878.7656,966.5 879,966.7656 Q879.25,967.0156 879.25,967.375 Q879.25,967.7188 878.9063,968.125 Q878.4063,968.7188 877.6094,969.0469 Q876.5625,969.5 875.2813,969.5 Q873.7813,969.5 872.5781,968.9063 Q871.6094,968.4375 870.9219,967.4219 Q870.25,966.4063 870.25,965.2031 L870.25,964.1094 Q870.25,962.8594 870.8438,961.7656 Q871.4531,960.6719 872.5,960.0938 Q873.5625,959.5 874.75,959.5 Q875.4688,959.5 876.0938,959.75 Q876.7188,960 877.25,960.5 Z "/><ellipse cx="900.75" cy="963.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="906.75" y="968.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="933.75" y="968.9102">CalypsoSam</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="809.5" x2="1058.5" y1="980" y2="980"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="809.5" x2="1058.5" y1="988" y2="988"/><polygon fill="#4177AF" points="819.5,995,815.5,1001,823.5,1001" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="828.5" y="1003.4189">CalypsoSam(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="892.5" y="1003.4189">SeResponse selectionResponse</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="4" x="1049.5" y="1003.4189">)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="831.5" y="1017.2549"/><ellipse cx="819.5" cy="1026.6719" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="828.5" y="1031.0908">SamRevision getSamRevision()</text><ellipse cx="819.5" cy="1040.5078" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="828.5" y="1044.9268">byte[] getSerialNumber()</text><ellipse cx="819.5" cy="1054.3438" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="828.5" y="1058.7627">byte getPlatform()</text><ellipse cx="819.5" cy="1068.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="828.5" y="1072.5986">byte getApplicationType()</text><ellipse cx="819.5" cy="1082.0156" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="828.5" y="1086.4346">byte getApplicationSubType()</text><ellipse cx="819.5" cy="1095.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="828.5" y="1100.2705">byte getSoftwareIssuer()</text><!--MD5=[2296a6a537aebb6d062261368584c4c8]
class PoRevokedService--><rect fill="#FEFECE" height="61.8359" id="PoRevokedService" style="stroke: #D4AC0D; stroke-width: 1.5;" width="186" x="199" y="563.5"/><ellipse cx="230.65" cy="579.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #B4A7E5; stroke-width: 1.0;"/><path d="M231.65,576.5 L231.65,582.5 L233.65,582.5 L234.1344,582.5 L234.65,583.125 L234.65,583.5 L234.65,583.875 L234.1344,584.5 L233.65,584.5 L227.65,584.5 L227.1656,584.5 L226.65,583.875 L226.65,583.5 L226.65,583.125 L227.1656,582.5 L227.65,582.5 L229.65,582.5 L229.65,576.5 L227.65,576.5 L227.1656,576.5 L226.65,575.875 L226.65,575.5 L226.65,575.125 L227.1656,574.5 L227.65,574.5 L233.65,574.5 L234.1344,574.5 L234.65,575.125 L234.65,575.5 L234.65,575.875 L234.1344,576.5 L233.65,576.5 L231.65,576.5 Z "/><ellipse cx="253.35" cy="579" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="106" x="259.35" y="584.4102">PoRevokedService</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="200" x2="384" y1="595.5" y2="595.5"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="200" x2="384" y1="603.5" y2="603.5"/><ellipse cx="210" cy="614.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="219" y="618.9189">isPoRevoked(byte[] 8bytesSerial)</text><!--MD5=[1ac61061803296a84828c176919fd8e8]
class PoHceService--><rect fill="#FEFECE" height="61.8359" id="PoHceService" style="stroke: #D4AC0D; stroke-width: 1.5;" width="317" x="86.5" y="818"/><ellipse cx="196.25" cy="834" fill="#B4A7E5" rx="11" ry="11" style="stroke: #B4A7E5; stroke-width: 1.0;"/><path d="M197.25,831 L197.25,837 L199.25,837 L199.7344,837 L200.25,837.625 L200.25,838 L200.25,838.375 L199.7344,839 L199.25,839 L193.25,839 L192.7656,839 L192.25,838.375 L192.25,838 L192.25,837.625 L192.7656,837 L193.25,837 L195.25,837 L195.25,831 L193.25,831 L192.7656,831 L192.25,830.375 L192.25,830 L192.25,829.625 L192.7656,829 L193.25,829 L199.25,829 L199.7344,829 L200.25,829.625 L200.25,830 L200.25,830.375 L199.7344,831 L199.25,831 L197.25,831 Z "/><ellipse cx="221.75" cy="833.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="78" x="227.75" y="838.9102">PoHceService</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="402.5" y1="850" y2="850"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="402.5" y1="858" y2="858"/><ellipse cx="97.5" cy="869" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="291" x="106.5" y="873.4189">boolean isCalypsoSerialExpired(byte[] 2bytesExpirationData)</text><!--MD5=[e8e21ba3995782366e9aa9ad2c6b2d5f]
class PoResource--><rect fill="#FEFECE" height="75.6719" id="PoResource" style="stroke: #D4AC0D; stroke-width: 1.5;" width="191" x="181.5" y="989.5"/><ellipse cx="203.25" cy="1005.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M205.25,1002 Q205.4531,1001.5 205.6875,1001.25 Q205.9219,1001 206.1875,1001 Q206.6563,1001 206.9531,1001.2813 Q207.25,1001.5625 207.25,1002.2188 L207.25,1003.7813 Q207.25,1004.4375 206.9688,1004.7188 Q206.6875,1005 206.25,1005 Q205.8594,1005 205.6094,1004.8281 Q205.3594,1004.6563 205.25,1004.2031 Q205.2031,1003.8906 205.0313,1003.7188 Q204.7188,1003.3906 204.1563,1003.2031 Q203.5938,1003 203.0313,1003 Q202.3281,1003 201.7344,1003.2813 Q201.1563,1003.5625 200.7031,1004.1875 Q200.25,1004.8125 200.25,1005.6719 L200.25,1006.5938 Q200.25,1007.625 201.0938,1008.3125 Q201.9375,1009 203.4375,1009 Q204.3281,1009 204.9531,1008.7969 Q205.3125,1008.6875 205.7188,1008.3281 Q205.9844,1008.125 206.125,1008.0625 Q206.2656,1008 206.4375,1008 Q206.7656,1008 207,1008.2656 Q207.25,1008.5156 207.25,1008.875 Q207.25,1009.2188 206.9063,1009.625 Q206.4063,1010.2188 205.6094,1010.5469 Q204.5625,1011 203.2813,1011 Q201.7813,1011 200.5781,1010.4063 Q199.6094,1009.9375 198.9219,1008.9219 Q198.25,1007.9063 198.25,1006.7031 L198.25,1005.6094 Q198.25,1004.3594 198.8438,1003.2656 Q199.4531,1002.1719 200.5,1001.5938 Q201.5625,1001 202.75,1001 Q203.4688,1001 204.0938,1001.25 Q204.7188,1001.5 205.25,1002 Z "/><ellipse cx="223.75" cy="1005" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="229.75" y="1010.4102">SeResource</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="62" x="313.5" y="986.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="60" x="314.5" y="999.957">CalypsoPo</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="182.5" x2="371.5" y1="1021.5" y2="1021.5"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="182.5" x2="371.5" y1="1029.5" y2="1029.5"/><ellipse cx="192.5" cy="1040.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="201.5" y="1044.9189">SeResource(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="265.5" y="1044.9189">SeReader seReader</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="3" x="363.5" y="1044.9189">,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="201.5" y="1058.7549">CalypsoPo po);</text><!--MD5=[7d16591ce1ac0fb103d5c2b0f24533d6]
class SvSetting--><rect fill="#FEFECE" height="48" id="SvSetting" style="stroke: #D4AC0D; stroke-width: 1.5;" width="121" x="131.5" y="1964"/><ellipse cx="146.5" cy="1980" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M148.5,1976.5 Q148.7031,1976 148.9375,1975.75 Q149.1719,1975.5 149.4375,1975.5 Q149.9063,1975.5 150.2031,1975.7813 Q150.5,1976.0625 150.5,1976.7188 L150.5,1978.2813 Q150.5,1978.9375 150.2188,1979.2188 Q149.9375,1979.5 149.5,1979.5 Q149.1094,1979.5 148.8594,1979.3281 Q148.6094,1979.1563 148.5,1978.7031 Q148.4531,1978.3906 148.2813,1978.2188 Q147.9688,1977.8906 147.4063,1977.7031 Q146.8438,1977.5 146.2813,1977.5 Q145.5781,1977.5 144.9844,1977.7813 Q144.4063,1978.0625 143.9531,1978.6875 Q143.5,1979.3125 143.5,1980.1719 L143.5,1981.0938 Q143.5,1982.125 144.3438,1982.8125 Q145.1875,1983.5 146.6875,1983.5 Q147.5781,1983.5 148.2031,1983.2969 Q148.5625,1983.1875 148.9688,1982.8281 Q149.2344,1982.625 149.375,1982.5625 Q149.5156,1982.5 149.6875,1982.5 Q150.0156,1982.5 150.25,1982.7656 Q150.5,1983.0156 150.5,1983.375 Q150.5,1983.7188 150.1563,1984.125 Q149.6563,1984.7188 148.8594,1985.0469 Q147.8125,1985.5 146.5313,1985.5 Q145.0313,1985.5 143.8281,1984.9063 Q142.8594,1984.4375 142.1719,1983.4219 Q141.5,1982.4063 141.5,1981.2031 L141.5,1980.1094 Q141.5,1978.8594 142.0938,1977.7656 Q142.7031,1976.6719 143.75,1976.0938 Q144.8125,1975.5 146,1975.5 Q146.7188,1975.5 147.3438,1975.75 Q147.9688,1976 148.5,1976.5 Z "/><ellipse cx="165.5" cy="1979.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="171.5" y="1984.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="198.5" y="1984.9102">SvSetting</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="132.5" x2="251.5" y1="1996" y2="1996"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="132.5" x2="251.5" y1="2004" y2="2004"/><!--MD5=[cca5d97aaf46870920fae66c9bd85cdd]
class Operation--><rect fill="#FEFECE" height="75.6719" id="Operation" style="stroke: #D4AC0D; stroke-width: 1.5;" width="97" x="86.5" y="2094"/><ellipse cx="101.5" cy="2110" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M100,2111 L100,2113 L104,2113 L104,2112 L104,2111.5156 L104.625,2111 L105,2111 L105.375,2111 L106,2111.5156 L106,2112 L106,2115 L98,2115 L97.5156,2115 L97,2114.375 L97,2114 L97,2113.625 L97.5156,2113 L98,2113 L98,2113 L98,2107 L98,2107 L97.5156,2107 L97,2106.375 L97,2106 L97,2105.625 L97.5156,2105 L98,2105 L106,2105 L106,2108 L106,2108.4844 L105.375,2109 L105,2109 L104.625,2109 L104,2108.4844 L104,2108 L104,2107 L100,2107 L100,2109 L101,2109 L101,2108.5156 L101,2108.5156 L101.625,2108 L102,2108 L102.375,2108 L103,2108.5156 L103,2109 L103,2111 L103,2111.4844 L102.375,2112 L102.375,2112 L102,2112 L101.625,2112 L101,2111.4844 L101,2111.4844 L101,2111 L100,2111 Z "/><ellipse cx="120.5" cy="2109.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="54" x="126.5" y="2114.9102">Operation</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="182.5" y1="2126" y2="2126"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="92.5" y="2141.4189">RELOAD,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="92.5" y="2155.2549">DEBIT</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="182.5" y1="2161.6719" y2="2161.6719"/><!--MD5=[f8e7078f77c005d15b486c0c98deb1e6]
class Action--><rect fill="#FEFECE" height="75.6719" id="Action" style="stroke: #D4AC0D; stroke-width: 1.5;" width="76" x="219" y="2094"/><ellipse cx="234" cy="2110" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M232.5,2111 L232.5,2113 L236.5,2113 L236.5,2112 L236.5,2111.5156 L237.125,2111 L237.5,2111 L237.875,2111 L238.5,2111.5156 L238.5,2112 L238.5,2115 L230.5,2115 L230.0156,2115 L229.5,2114.375 L229.5,2114 L229.5,2113.625 L230.0156,2113 L230.5,2113 L230.5,2113 L230.5,2107 L230.5,2107 L230.0156,2107 L229.5,2106.375 L229.5,2106 L229.5,2105.625 L230.0156,2105 L230.5,2105 L238.5,2105 L238.5,2108 L238.5,2108.4844 L237.875,2109 L237.5,2109 L237.125,2109 L236.5,2108.4844 L236.5,2108 L236.5,2107 L232.5,2107 L232.5,2109 L233.5,2109 L233.5,2108.5156 L233.5,2108.5156 L234.125,2108 L234.5,2108 L234.875,2108 L235.5,2108.5156 L235.5,2109 L235.5,2111 L235.5,2111.4844 L234.875,2112 L234.875,2112 L234.5,2112 L234.125,2112 L233.5,2111.4844 L233.5,2111.4844 L233.5,2111 L232.5,2111 Z "/><ellipse cx="253" cy="2109.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="33" x="259" y="2114.9102">Action</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="220" x2="294" y1="2126" y2="2126"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="225" y="2141.4189">DO,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="29" x="225" y="2155.2549">UNDO</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="220" x2="294" y1="2161.6719" y2="2161.6719"/><!--MD5=[67d91b3e56e3fb89140abbb352fa8438]
class LogRead--><rect fill="#FEFECE" height="75.6719" id="LogRead" style="stroke: #D4AC0D; stroke-width: 1.5;" width="94" x="330" y="2094"/><ellipse cx="345" cy="2110" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M343.5,2111 L343.5,2113 L347.5,2113 L347.5,2112 L347.5,2111.5156 L348.125,2111 L348.5,2111 L348.875,2111 L349.5,2111.5156 L349.5,2112 L349.5,2115 L341.5,2115 L341.0156,2115 L340.5,2114.375 L340.5,2114 L340.5,2113.625 L341.0156,2113 L341.5,2113 L341.5,2113 L341.5,2107 L341.5,2107 L341.0156,2107 L340.5,2106.375 L340.5,2106 L340.5,2105.625 L341.0156,2105 L341.5,2105 L349.5,2105 L349.5,2108 L349.5,2108.4844 L348.875,2109 L348.5,2109 L348.125,2109 L347.5,2108.4844 L347.5,2108 L347.5,2107 L343.5,2107 L343.5,2109 L344.5,2109 L344.5,2108.5156 L344.5,2108.5156 L345.125,2108 L345.5,2108 L345.875,2108 L346.5,2108.5156 L346.5,2109 L346.5,2111 L346.5,2111.4844 L345.875,2112 L345.875,2112 L345.5,2112 L345.125,2112 L344.5,2111.4844 L344.5,2111.4844 L344.5,2111 L343.5,2111 Z "/><ellipse cx="364" cy="2109.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="370" y="2114.9102">LogRead</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="331" x2="423" y1="2126" y2="2126"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="336" y="2141.4189">SINGLE,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="336" y="2155.2549">ALL</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="331" x2="423" y1="2161.6719" y2="2161.6719"/><!--MD5=[50d6b8eba543a732d1dd3c761d982397]
class NegativeBalance--><rect fill="#FEFECE" height="75.6719" id="NegativeBalance" style="stroke: #D4AC0D; stroke-width: 1.5;" width="136" x="288" y="1950"/><ellipse cx="303" cy="1966" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M301.5,1967 L301.5,1969 L305.5,1969 L305.5,1968 L305.5,1967.5156 L306.125,1967 L306.5,1967 L306.875,1967 L307.5,1967.5156 L307.5,1968 L307.5,1971 L299.5,1971 L299.0156,1971 L298.5,1970.375 L298.5,1970 L298.5,1969.625 L299.0156,1969 L299.5,1969 L299.5,1969 L299.5,1963 L299.5,1963 L299.0156,1963 L298.5,1962.375 L298.5,1962 L298.5,1961.625 L299.0156,1961 L299.5,1961 L307.5,1961 L307.5,1964 L307.5,1964.4844 L306.875,1965 L306.5,1965 L306.125,1965 L305.5,1964.4844 L305.5,1964 L305.5,1963 L301.5,1963 L301.5,1965 L302.5,1965 L302.5,1964.5156 L302.5,1964.5156 L303.125,1964 L303.5,1964 L303.875,1964 L304.5,1964.5156 L304.5,1965 L304.5,1967 L304.5,1967.4844 L303.875,1968 L303.875,1968 L303.5,1968 L303.125,1968 L302.5,1967.4844 L302.5,1967.4844 L302.5,1967 L301.5,1967 Z "/><ellipse cx="322" cy="1965.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="93" x="328" y="1970.9102">NegativeBalance</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="289" x2="423" y1="1982" y2="1982"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="294" y="1997.4189">FORBIDDEN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="294" y="2011.2549">AUTHORIZED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="289" x2="423" y1="2017.6719" y2="2017.6719"/><!--MD5=[b5831fe2f38c217483a231289f3a8748]
link PoSecuritySettingBuilder to PoSecuritySetting--><path d="M498.536,361.23 C509.649,386.67 521.226,413.17 532.416,438.79 " fill="none" id="PoSecuritySettingBuilder-PoSecuritySetting" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="518" y="405.4951">build</text><polygon fill="#000000" points="527,414.3516,530,420.3516,533,414.3516,527,414.3516" style="stroke: #000000; stroke-width: 1.0;"/><!--MD5=[5d6d67a6e099206d95b683be9999b9cd]
reverse link PoSecuritySetting to SamRevokedService--><path d="M776.896,594.5 C784.239,594.5 791.583,594.5 798.926,594.5 " fill="none" id="PoSecuritySetting&lt;-SamRevokedService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="763.678,594.5,769.678,598.5,775.678,594.5,769.678,590.5,763.678,594.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="771.2533" y="591.6432">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="769.0383" y="591.6443">0..1</text><!--MD5=[a40139effe78355afd96e1fe38f816a4]
reverse link PoSecuritySetting to SamResource--><path d="M773.921,743.19 C776.959,745.49 779.987,747.76 783,750 C811.736,771.32 844.974,793.18 872.938,810.82 " fill="none" id="PoSecuritySetting&lt;-SamResource" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="763.56,735.27,765.8974,742.0918,773.0935,742.5579,770.756,735.7361,763.56,735.27" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="771.7488" y="739.2075">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="837.7457" y="800.1498">0..1</text><!--MD5=[df9e65eec241e7a0900f3f2cc1715dea]
link SamRevokedService to SamResource--><!--MD5=[f5f07a045c16f9b5b991b6ad223e4b75]
reverse link SamResource to CalypsoSam--><path d="M934,900.07 C934,914.91 934,931.54 934,947.74 " fill="none" id="SamResource&lt;-CalypsoSam" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="934,887,930,893,934,899,938,893,934,887" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="926.4203" y="908.1702">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="926.6773" y="937.1754">1</text><!--MD5=[4887dba8439a7c195496dbe34ec42e74]
reverse link PoSecuritySetting to PoRevokedService--><path d="M423.222,594.5 C410.562,594.5 397.902,594.5 385.242,594.5 " fill="none" id="PoSecuritySetting&lt;-PoRevokedService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="436.415,594.5,430.415,590.5,424.415,594.5,430.415,598.5,436.415,594.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="421.3218" y="591.619">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="392.8973" y="591.4266">0..1</text><!--MD5=[c7931a5b3688f34377874a4d447492d9]
reverse link PoSecuritySetting to PoHceService--><path d="M425.579,746.06 C423.717,747.39 421.857,748.7 420,750 C383.607,775.43 340.056,799.84 305.504,817.93 " fill="none" id="PoSecuritySetting&lt;-PoHceService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="436.263,738.31,429.0575,738.5932,426.5475,745.3534,433.7531,745.0702,436.263,738.31" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="421.5944" y="741.9696">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="289.8955" y="806.935">0..1</text><!--MD5=[fabfb25c6922ca0223a52cadcead3358]
link PoRevokedService to PoHceService--><!--MD5=[553a2f1231a528299e1fdd03d75ee317]
link PoHceService to PoResource--><!--MD5=[49b2cd243b315032ac87ae560f8bd7c4]
reverse link SvSetting to Operation--><path d="M177.048,2026.25 C168.694,2047.061 158.316,2072.915 149.961,2093.73 " fill="none" id="SvSetting&lt;-Operation" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="179.7344" cy="2019.555" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="176.7538" x2="182.715" y1="2026.979" y2="2012.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="172.3104" x2="187.1584" y1="2016.5744" y2="2022.5356"/><!--MD5=[ad0f2bead1761192d1c3cbd4a713f69a]
reverse link SvSetting to Action--><path d="M208.912,2025.947 C218.462,2046.81 230.365,2072.814 239.94,2093.73 " fill="none" id="SvSetting&lt;-Action" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="205.9176" cy="2019.4052" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="209.2473" x2="202.588" y1="2026.6793" y2="2012.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="198.6435" x2="213.1918" y1="2022.7348" y2="2016.0755"/><!--MD5=[40b37511570e7b53b6592a746222781a]
reverse link SvSetting to LogRead--><path d="M234.136,2021.342 C262.655,2043.232 300.362,2072.175 329.876,2094.829 " fill="none" id="SvSetting&lt;-LogRead" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="228.481" cy="2017.0021" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="234.8271" x2="222.135" y1="2021.8733" y2="2012.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223.6099" x2="233.3522" y1="2023.3482" y2="2010.6561"/><!--MD5=[8d1c764bcc19989851e984ffe55e2961]
reverse link SvSetting to NegativeBalance--><path d="M267.647,1988 C274.331,1988 281.015,1988 287.7,1988 " fill="none" id="SvSetting&lt;-NegativeBalance" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="260.539" cy="1988" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="268.539" x2="252.539" y1="1988" y2="1988"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="260.539" x2="260.539" y1="1996" y2="1980"/><!--MD5=[e4e6b0c197a4fe408c8d4c7214bc9356]
link PoResource to PoTransaction--><path d="M305.862,1065.82 C323.918,1089.16 349.19,1121.84 378.022,1159.12 " fill="none" id="PoResource-&gt;PoTransaction" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="386.245,1169.75,385.7365,1162.5568,378.9011,1160.2596,379.4096,1167.4528,386.245,1169.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="302.9041" y="1086.7515">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="372.7234" y="1158.7107">1</text><!--MD5=[7ef23bb65cbd7f21990abf12f0f9fb41]
link PoSecuritySetting to PoTransaction--><path d="M610.141,750.03 C617.41,860.79 627.518,1014.81 636.809,1156.38 " fill="none" id="PoSecuritySetting-&gt;PoTransaction" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="637.676,1169.6,641.2785,1163.3533,636.8979,1157.6253,633.2954,1163.872,637.676,1169.6" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="588.0994" y="771.4575">0..1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="630.1311" y="1159.6955">1</text><!--MD5=[4e36a4e3a201b7955d2f14bdee0043a9]
reverse link PoTransaction to SessionState--><path d="M549.306,1896.634 C544.071,1913.961 539.349,1929.587 535.362,1942.782 " fill="none" id="PoTransaction&lt;-SessionState" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="551.4004" cy="1889.7008" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="549.0857" x2="553.715" y1="1897.3587" y2="1882.043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="543.7425" x2="559.0582" y1="1887.3862" y2="1892.0155"/><!--MD5=[ce3c63ddc54d4d675759c68b3655a59d]
reverse link PoTransaction to SessionSetting--><path d="M689.98,1897.306 C692.137,1924.863 693.953,1948.071 695.198,1963.972 " fill="none" id="PoTransaction&lt;-SessionSetting" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="689.41" cy="1890.0186" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="690.034" x2="688.786" y1="1897.9943" y2="1882.043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="681.4344" x2="697.3856" y1="1890.6426" y2="1889.3946"/><!--MD5=[01907a979ee07ab82f1dc532a4541c2c]
reverse link SessionSetting to EncryptionMode--><path d="M706.864,2026.857 C712.259,2047.563 718.918,2073.117 724.289,2093.73 " fill="none" id="SessionSetting&lt;-EncryptionMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="705.0445" cy="2019.8724" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="707.0619" x2="703.027" y1="2027.6139" y2="2012.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="697.303" x2="712.7859" y1="2021.8899" y2="2017.855"/><!--MD5=[19a5bab6cb0e733f5b38e95cd959a25a]
reverse link SessionSetting to ModificationMode--><path d="M657.978,2021.788 C632.412,2043.269 598.934,2071.399 572.357,2093.73 " fill="none" id="SessionSetting&lt;-ModificationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="663.3458" cy="2017.2771" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="657.2207" x2="669.471" y1="2022.4232" y2="2012.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="658.1997" x2="668.4919" y1="2011.1519" y2="2023.4023"/><!--MD5=[0e9a2e2ec4d6aea28d869b2d373dbe85]
reverse link SessionSetting to RatificationMode--><path d="M761.402,2018.65 C787.546,2031.394 817.719,2047.02 844,2063 C859.317,2072.313 875.345,2083.37 889.739,2093.832 " fill="none" id="SessionSetting&lt;-RatificationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="754.951" cy="2015.5436" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="762.1589" x2="747.743" y1="2019.0143" y2="2012.073"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="751.4803" x2="758.4216" y1="2022.7516" y2="2008.3357"/><!--MD5=[d0f8f68742f1a8058f4f2e5a0ad06650]
reverse link SessionSetting to AccessLevel--><path d="M748.843,2020.737 C773.817,2038.928 801.62,2064.095 817,2094 C839.265,2137.294 841.391,2193.947 839.471,2232.68 " fill="none" id="SessionSetting&lt;-AccessLevel" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="743.0605" cy="2016.7031" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="749.6211" x2="736.5" y1="2021.2813" y2="2012.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="738.4824" x2="747.6387" y1="2023.2637" y2="2010.1426"/><!--MD5=[37e957bec1fd56bfe0d2d70b2ed06b69]
link EncryptionMode to AccessLevel--><!--MD5=[aad50e08903197c6896398c3f9217d50]
reverse link SessionSetting to AuthenticationMode--><path d="M678.568,2025.923 C669.265,2045.725 658.411,2070.77 651,2094 C635.22,2143.462 624.321,2202.581 618.366,2239.964 " fill="none" id="SessionSetting&lt;-AuthenticationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="681.6834" cy="2019.4384" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="678.2198" x2="685.147" y1="2026.6497" y2="2012.227"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="674.4721" x2="688.8948" y1="2015.9748" y2="2022.9019"/><!--MD5=[6952bc2877cf5d205c9a3c02c8dd195c]
link ModificationMode to AuthenticationMode--><!--MD5=[079f273270ef1dd73893779fe3d467bc]
reverse link PoTransaction to PinTransmissionMode--><path d="M779.536,1895.037 C783.56,1901.161 787.713,1907.155 792,1913 C802.221,1926.935 815.834,1939.351 829.746,1949.849 " fill="none" id="PoTransaction&lt;-PinTransmissionMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="775.7405" cy="1889.0496" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="780.0239" x2="771.457" y1="1895.8062" y2="1882.293"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.9838" x2="782.4971" y1="1893.3331" y2="1884.7662"/><!--MD5=[746f3c5b2505d7b38384202071141ba9]
reverse link PoTransaction to SvSetting--><path d="M288.151,1892.694 C257.993,1922.273 232.587,1947.192 215.479,1963.972 " fill="none" id="PoTransaction&lt;-SvSetting" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="293.2989" cy="1887.6451" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287.5879" x2="299.01" y1="1893.2472" y2="1882.043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287.6968" x2="298.9011" y1="1881.9341" y2="1893.3562"/><!--MD5=[28e38a2b5aeddf77f446bb48690e6362]
link SessionState to SessionSetting--><!--MD5=[bc4e75526f74fbb68a5aed8e4c56686a]
link SessionSetting to PinTransmissionMode--><!--MD5=[15b34b46d09c17d92f3246bd8d6b690e]
link PinTransmissionMode to SvSetting--><!--MD5=[3429ec821e60fb1fffd23386c89f33c5]
link PoTransaction to SelectFileControl--><path d="M1021.5,1882.141 C1033.85,1915.555 1041,1950.615 1041,1987 C1041,1987 1041,1987 1041,2279 C1041,2322.351 1009.78,2359.25 977.706,2385.719 " fill="none" id="PoTransaction-SelectFileControl" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[30641f45b0628209a5479aad6dfa6f2f]
link PoTransaction to ChannelControl--><path d="M1043.16,1849.091 C1064.83,1891.813 1078,1937.955 1078,1987 C1078,1987 1078,1987 1078,2279 C1078,2317.799 1078,2362.205 1078,2392.767 " fill="none" id="PoTransaction-ChannelControl" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[75cf09f748786ce5d6dd001ad977eb2a]
link AuthenticationMode to SelectFileControl--><!--MD5=[816c1fefc9463d481f66103582bcea7c]
link SelectFileControl to ChannelControl--><!--MD5=[61059ea44804cedf0b18e7f9c345f953]
@startuml
skinparam ClassBorderColor #D4AC0D
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
skinparam shadowing false

skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #EAFAF1
skinparam ClassBorderColor<<green>> #2ECC71
hide <<green>> stereotype
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

together {
  together {

    +class "static <b>final</b> PoSecuritySettingBuilder" as PoSecuritySettingBuilder {
      -final SamResource samResource
      -List<Byte> authorizedKvcList
      -final EnumMap<AccessLevel, Byte> defaultKif
      -final EnumMap<AccessLevel, Byte> defaultKvc
      -final EnumMap<AccessLevel, Byte> defaultKeyRecordNumber
      ModificationMode sessionModificationMode = ATOMIC
      RatificationMode ratificationMode = CLOSE_RATIFIED

      +PoSecuritySettingsBuilder(SamResource samResource)

      +PoSecuritySettingsBuilder sessionModificationMode(ModificationMode sessionModificationMode)
      +PoSecuritySettingsBuilder ratificationMode(RatificationMode ratificationMode)
      +PoSecuritySettingsBuilder sessionDefaultKif(AccessLevel sessionAccessLevel, byte kif)
      +PoSecuritySettingsBuilder sessionDefaultKvc(AccessLevel sessionAccessLevel, byte kvc)
      +PoSecuritySettingsBuilder sessionDefaultKeyRecordNumber(AccessLevel sessionAccessLevel,
        byte keyRecordNumber)
      +PoSecuritySettingsBuilder sessionAuthorizedKvcList(List<Byte> authorizedKvcList)

      +PoSecuritySettings build()
    }

    note as N1
    Default values in PoTransaction if PoSecuritySetting doesn't specify it:
      - session ModificationMode as ATOMIC
      - session RatificationMode as CLOSE_RATIFIED
      - PinTransmissionMode as ENCRYPTED if PoSecurity defined
      - any KIF/KVC values are authorized
      - no verification is done for: HCE token expiration, revoked PO or SAM
    end note

    PoSecuritySettingBuilder .right. N1

    +class "<b>final</b> PoSecuritySetting" as PoSecuritySetting {
      +PoSecuritySetting(SamResource samResource);
      #PoRevokedService getPoRevokedService()
      #SamRevokedService getSamRevokedService()
      #PoHceService getPoHceService()

      +loadProperties(Properties propertyFile)

      #ModificationMode getSessionModificationMode()
      #RatificationMode getSessionRatificationMode()
      #Byte getSessionDefaultKif(AccessLevel level)
      #Byte getSessionDefaultKvc(AccessLevel level)
      #Byte getSessionDefaultKeyRecordNumber(AccessLevel level)
      #Boolean isSessionKvcAuthorized(byte kvc)

      #PinTransmissionMode getPinTransmissionMode()

      #LogRead getSvGetLogReadMode()
      #NegativeBalance getSvNegativeBalance()
      #Boolean isSvKvcAuthorized(byte kvc)
    }

    PoSecuritySettingBuilder -down- PoSecuritySetting : build >

    together {
      +interface SamRevokedService {
        +isSamRevoked(byte[] 4bytesSerial, byte[][0..1] 3bytesCounter)
      }

      +class "SeResource<CalypsoSam>" as SamResource {
        +SeResource(<color:red>SeReader seReader</color>,
          CalypsoSam sam);
      }

      +class "<b>final</b> CalypsoSam" as CalypsoSam {
        ~CalypsoSam(<color:red>SeResponse selectionResponse</color>)

        +SamRevision getSamRevision()
        +byte[] getSerialNumber()
        +byte getPlatform()
        +byte getApplicationType()
        +byte getApplicationSubType()
        +byte getSoftwareIssuer()
      }
    }
   PoSecuritySetting "1" o-right- "0..1" SamRevokedService
   PoSecuritySetting "1 " o-right- " 0..1" SamResource
   SamRevokedService -down[hidden]- SamResource
   SamResource "1" o-down- "1" CalypsoSam

    together {
      +interface PoRevokedService {
        +isPoRevoked(byte[] 8bytesSerial)
      }

      +interface PoHceService {
        +boolean isCalypsoSerialExpired(byte[] 2bytesExpirationData)
      }

      +class "SeResource<CalypsoPo>" as PoResource {
        +SeResource(<color:red>SeReader seReader</color>,
          CalypsoPo po);
      }
    }
    PoRevokedService "0..1" -right-o "1" PoSecuritySetting
    PoHceService "0..1 " -right-o " 1" PoSecuritySetting
    PoRevokedService -down[hidden]- PoHceService
    PoHceService -down[hidden]- PoResource

    +class PoTransaction {
      +PoTransaction(PoResource poResource, PoSecuritySetting[0..1] securitySetting)

      +<b>final</b> processPoCommands(ChannelControl channel)
      +<b>final</b> processOpening(AccessLevel level)
      +<b>final</b> processPoCommandsInSession()
      +<b>final</b> processClosing(ChannelControl channel)
      +<b>final</b> processCancel(ChannelControl channel)
      +<b>final</b> prepareManageSession(EncryptionMode encMode, AuthenticationMode authMode)
      +<b>final</b> SessionSecureData getSessionSecureData()

      +<b>final</b> prepareCheckPinStatus()
      +<b>final</b> prepareVerifyPin(String pin)
      +<b>final</b> prepareVerifyPin(byte[] pin)

      +<b>final</b> prepareSvGet(SvSetting.Operation operation, SvSetting.Action action)
      +<b>final</b> prepareSvReload(int amount, int date, int time, String free)
      +<b>final</b> prepareSvReload(int amount, byte[] date, byte[] time, byte[] free)
      +<b>final</b> prepareSvReload(int amount)
      +<b>final</b> prepareSvDebit(int amount, int date, int time)
      +<b>final</b> prepareSvDebit(int amount, byte[] date, byte[] time)
      +<b>final</b> prepareSvDebit(int amount)
      +<b>final</b> SvOperationSecureData getSvOperationSecureData()

      +<b>final</b> prepareSelectFile(short lid)
      +<b>final</b> prepareSelectFile(byte[] lid)
      +<b>final</b> prepareSelectFile(SelectFileControl control)
      +<b>final</b> prepareReadRecordFile(byte sfi, int recordNumber)
      +<b>final</b> prepareReadRecordFile(byte sfi, int firstRecordNumber, int numberOfRecords, int recordSize))
      +<b>final</b> prepareReadSubRecordFile(byte sfi, int firstRecordNumber, int numberOfRecord, int recordOffset, int recordLength)
      +<b>final</b> prepareReadBinaryFile(byte sfi, int dataLength, int[0..1] dataOffset)
      +<b>final</b> prepareReadCounterFile(byte sfi, int countersNumber)
      +<b>final</b> prepareAppendRecord(byte sfi, byte[] recordData)
      +<b>final</b> prepareUpdateRecord(byte sfi, int recordNumber, byte[] recordData)
      +<b>final</b> prepareWriteRecord(byte sfi, int recordNumber, byte[] recordData)
      +<b>final</b> prepareUpdateBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)
      +<b>final</b> prepareWriteBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)
      +<b>final</b> prepareIncreaseCounter(byte sfi, int counterNumber, int incValue)
      +<b>final</b> prepareDecreaseCounter(byte sfi, int counterNumber, int decValue)
      +<b>final</b> prepareSetCounter(byte sfi, int counterNumber, int newValue)
      +<b>final</b> int prepareSearchRecord(byte sfi, byte offset, SearchOffsetMode offsetMode, byte[] searchData, Byte[] searchMask, SearchReadMode readMode)
      +<b>final</b> int[] getSearchResult(int searchRequestNumber)

      +<b>final</b> prepareInvalidate()
      +<b>final</b> prepareRehabilitate()

      +<b>final</b> prepareChangeKey(AccessLevel level)
      +<b>final</b> prepareChangePin(String pin)
      +<b>final</b> prepareChangePin(byte[] pin)
    }

    -enum SessionState {
      SESSION_UNITIALIZED,
      SESSION_OPEN,
      SESSION_CLOSED
    }

    +class "<b>final</b> SessionSetting" as SessionSetting {
    }

    +enum AccessLevel {
      SESSION_LVL_PERSO("perso", byte 0x01),
      SESSION_LVL_LOAD("load", byte 0x02),
      SESSION_LVL_DEBIT("debit", byte 0x03)
    }

    +enum ModificationMode {
      ATOMIC,
      MULTIPLE
    }

    +enum RatificationMode {
      CLOSE_RATIFIED,
      CLOSE_NOT_RATIFIED
    }

    +enum EncryptionMode {
      ACTIVATE,
      DEACTIVATE
    }

    +enum AuthenticationMode {
      REQUESTED,
      NOT_REQUESTED
    }

    +enum PinTransmissionMode {
      PLAIN,
      ENCRYPTED
    }

    together {
      +class "<b>final</b> SvSetting" as SvSetting {
      }

      +enum Operation {
        RELOAD,
        DEBIT
      }

      +enum Action {
        DO,
        UNDO
      }

      +enum LogRead {
        SINGLE,
        ALL
      }

      +enum NegativeBalance {
        FORBIDDEN,
        AUTHORIZED
      }

      SvSetting +-down- Operation
      SvSetting +-down- Action
      SvSetting +-down- LogRead
      SvSetting +-right- NegativeBalance
    }


    PoResource "1" - -o "1" PoTransaction
    PoTransaction "1" o-up- "0..1" PoSecuritySetting

    PoTransaction +-down- SessionState

    PoTransaction +-down- SessionSetting
    SessionSetting +-down- EncryptionMode
    SessionSetting +-down- ModificationMode
    SessionSetting +-down- RatificationMode
    SessionSetting +- - AccessLevel
    EncryptionMode -down[hidden]- AccessLevel
    SessionSetting +- - AuthenticationMode
    ModificationMode -down[hidden]- AuthenticationMode

     PoTransaction +-down- PinTransmissionMode

    PoTransaction +-down- SvSetting

    SessionState -right[hidden]- SessionSetting
    SessionSetting -right[hidden]- PinTransmissionMode
    PinTransmissionMode -right[hidden]- SvSetting
  }

  +enum SelectFileControl {
    FIRST_EF,
    NEXT_EF,
    CURRENT_DF
  }

  +enum ChannelControl {
	KEEP_OPEN
	CLOSE_AFTER
  }

  PoTransaction - - SelectFileControl
  PoTransaction - - ChannelControl
  AuthenticationMode -down[hidden]- SelectFileControl
  ChannelControl -left[hidden]- SelectFileControl
}

@enduml

PlantUML version 1.2020.09(Sun May 10 14:51:06 MUT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.6+8-b765.40
Operating System: Windows 10
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>