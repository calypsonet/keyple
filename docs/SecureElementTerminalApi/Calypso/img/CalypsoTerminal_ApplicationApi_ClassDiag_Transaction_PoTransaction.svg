<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2500px" preserveAspectRatio="none" style="width:1201px;height:2500px;" version="1.1" viewBox="0 0 1201 2500" width="1201px" zoomAndPan="magnify"><defs/><g><!--MD5=[858307e347215d8034d295bce1f15f07]
class SelectFileControl--><rect fill="#FEFECE" height="89.5078" id="SelectFileControl" style="stroke: #D4AC0D; stroke-width: 1.5;" width="137" x="865.5" y="2400"/><ellipse cx="880.5" cy="2416" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M879,2417 L879,2419 L883,2419 L883,2418 L883,2417.5156 L883.625,2417 L884,2417 L884.375,2417 L885,2417.5156 L885,2418 L885,2421 L877,2421 L876.5156,2421 L876,2420.375 L876,2420 L876,2419.625 L876.5156,2419 L877,2419 L877,2419 L877,2413 L877,2413 L876.5156,2413 L876,2412.375 L876,2412 L876,2411.625 L876.5156,2411 L877,2411 L885,2411 L885,2414 L885,2414.4844 L884.375,2415 L884,2415 L883.625,2415 L883,2414.4844 L883,2414 L883,2413 L879,2413 L879,2415 L880,2415 L880,2414.5156 L880,2414.5156 L880.625,2414 L881,2414 L881.375,2414 L882,2414.5156 L882,2415 L882,2417 L882,2417.4844 L881.375,2418 L881.375,2418 L881,2418 L880.625,2418 L880,2417.4844 L880,2417.4844 L880,2417 L879,2417 Z "/><ellipse cx="899.5" cy="2415.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="905.5" y="2420.9102">SelectFileControl</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="866.5" x2="1001.5" y1="2432" y2="2432"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="871.5" y="2447.4189">FIRST_EF,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="871.5" y="2461.2549">NEXT_EF,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="871.5" y="2475.0908">CURRENT_DF</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="866.5" x2="1001.5" y1="2481.5078" y2="2481.5078"/><!--MD5=[4ea882bf7bd4263b7e27aeb216026ca4]
class PoSecuritySettingBuilder--><rect fill="#FEFECE" height="297.0469" id="PoSecuritySettingBuilder" style="stroke: #D4AC0D; stroke-width: 1.5;" width="486" x="235" y="64"/><ellipse cx="371.25" cy="80" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M373.25,76.5 Q373.4531,76 373.6875,75.75 Q373.9219,75.5 374.1875,75.5 Q374.6563,75.5 374.9531,75.7813 Q375.25,76.0625 375.25,76.7188 L375.25,78.2813 Q375.25,78.9375 374.9688,79.2188 Q374.6875,79.5 374.25,79.5 Q373.8594,79.5 373.6094,79.3281 Q373.3594,79.1563 373.25,78.7031 Q373.2031,78.3906 373.0313,78.2188 Q372.7188,77.8906 372.1563,77.7031 Q371.5938,77.5 371.0313,77.5 Q370.3281,77.5 369.7344,77.7813 Q369.1563,78.0625 368.7031,78.6875 Q368.25,79.3125 368.25,80.1719 L368.25,81.0938 Q368.25,82.125 369.0938,82.8125 Q369.9375,83.5 371.4375,83.5 Q372.3281,83.5 372.9531,83.2969 Q373.3125,83.1875 373.7188,82.8281 Q373.9844,82.625 374.125,82.5625 Q374.2656,82.5 374.4375,82.5 Q374.7656,82.5 375,82.7656 Q375.25,83.0156 375.25,83.375 Q375.25,83.7188 374.9063,84.125 Q374.4063,84.7188 373.6094,85.0469 Q372.5625,85.5 371.2813,85.5 Q369.7813,85.5 368.5781,84.9063 Q367.6094,84.4375 366.9219,83.4219 Q366.25,82.4063 366.25,81.2031 L366.25,80.1094 Q366.25,78.8594 366.8438,77.7656 Q367.4531,76.6719 368.5,76.0938 Q369.5625,75.5 370.75,75.5 Q371.4688,75.5 372.0938,75.75 Q372.7188,76 373.25,76.5 Z "/><ellipse cx="396.75" cy="79.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="402.75" y="84.9102">static</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="434.75" y="84.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="135" x="461.75" y="84.9102">PoSecuritySettingBuilder</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="236" x2="720" y1="96" y2="96"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="243" y="104"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="255" y="111.4189">final SamResource samResource</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="243" y="117.8359"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="255" y="125.2549">List&lt;Byte&gt; authorizedKvcList</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="243" y="131.6719"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="222" x="255" y="139.0908">final EnumMap&lt;AccessLevel, Byte&gt; defaultKif</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="243" y="145.5078"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="228" x="255" y="152.9268">final EnumMap&lt;AccessLevel, Byte&gt; defaultKvc</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="243" y="159.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="255" y="166.7627">final EnumMap&lt;AccessLevel, Byte&gt; defaultKeyRecordNumber</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="258" x="255" y="180.5986">ModificationMode sessionModificationMode = ATOMIC</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="254" x="255" y="194.4346">RatificationMode ratificationMode = CLOSE_RATIFIED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="236" x2="720" y1="200.8516" y2="200.8516"/><ellipse cx="246" cy="211.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="264" x="255" y="216.2705">PoSecuritySettingBuilder(SamResource samResource)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="258" y="230.1064"/><ellipse cx="246" cy="239.5234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="457" x="255" y="243.9424">PoSecuritySettingBuilder sessionModificationMode(ModificationMode sessionModificationMode)</text><ellipse cx="246" cy="253.3594" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="363" x="255" y="257.7783">PoSecuritySettingBuilder ratificationMode(RatificationMode ratificationMode)</text><ellipse cx="246" cy="267.1953" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="424" x="255" y="271.6143">PoSecuritySettingBuilder sessionDefaultKif(AccessLevel sessionAccessLevel, byte kif)</text><ellipse cx="246" cy="281.0313" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="436" x="255" y="285.4502">PoSecuritySettingBuilder sessionDefaultKvc(AccessLevel sessionAccessLevel, byte kvc)</text><ellipse cx="246" cy="294.8672" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="460" x="255" y="299.2861">PoSecuritySettingBuilder sessionDefaultKeyRecordNumber(AccessLevel sessionAccessLevel,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="255" y="313.1221">byte keyRecordNumber)</text><ellipse cx="246" cy="322.5391" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="397" x="255" y="326.958">PoSecuritySettingBuilder sessionAuthorizedKvcList(List&lt;Byte&gt; authorizedKvcList)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="258" y="340.7939"/><ellipse cx="246" cy="350.2109" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="255" y="354.6299">PoSecuritySetting build()</text><!--MD5=[e4d4ea7db949ad9d239210033b878e09]
class PoSecuritySetting--><rect fill="#FEFECE" height="310.8828" id="PoSecuritySetting" style="stroke: #D4AC0D; stroke-width: 1.5;" width="327" x="436.5" y="439"/><ellipse cx="528.75" cy="455" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M530.75,451.5 Q530.9531,451 531.1875,450.75 Q531.4219,450.5 531.6875,450.5 Q532.1563,450.5 532.4531,450.7813 Q532.75,451.0625 532.75,451.7188 L532.75,453.2813 Q532.75,453.9375 532.4688,454.2188 Q532.1875,454.5 531.75,454.5 Q531.3594,454.5 531.1094,454.3281 Q530.8594,454.1563 530.75,453.7031 Q530.7031,453.3906 530.5313,453.2188 Q530.2188,452.8906 529.6563,452.7031 Q529.0938,452.5 528.5313,452.5 Q527.8281,452.5 527.2344,452.7813 Q526.6563,453.0625 526.2031,453.6875 Q525.75,454.3125 525.75,455.1719 L525.75,456.0938 Q525.75,457.125 526.5938,457.8125 Q527.4375,458.5 528.9375,458.5 Q529.8281,458.5 530.4531,458.2969 Q530.8125,458.1875 531.2188,457.8281 Q531.4844,457.625 531.625,457.5625 Q531.7656,457.5 531.9375,457.5 Q532.2656,457.5 532.5,457.7656 Q532.75,458.0156 532.75,458.375 Q532.75,458.7188 532.4063,459.125 Q531.9063,459.7188 531.1094,460.0469 Q530.0625,460.5 528.7813,460.5 Q527.2813,460.5 526.0781,459.9063 Q525.1094,459.4375 524.4219,458.4219 Q523.75,457.4063 523.75,456.2031 L523.75,455.1094 Q523.75,453.8594 524.3438,452.7656 Q524.9531,451.6719 526,451.0938 Q527.0625,450.5 528.25,450.5 Q528.9688,450.5 529.5938,450.75 Q530.2188,451 530.75,451.5 Z "/><ellipse cx="554.25" cy="454.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="560.25" y="459.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="587.25" y="459.9102">PoSecuritySetting</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="437.5" x2="762.5" y1="471" y2="471"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="437.5" x2="762.5" y1="479" y2="479"/><ellipse cx="447.5" cy="490" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="456.5" y="494.4189">PoSecuritySetting(SamResource samResource);</text><polygon fill="#FFFF44" points="447.5,498.8359,451.5,502.8359,447.5,506.8359,443.5,502.8359" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="456.5" y="508.2549">PoRevokedService getPoRevokedService()</text><polygon fill="#FFFF44" points="447.5,512.6719,451.5,516.6719,447.5,520.6719,443.5,516.6719" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="226" x="456.5" y="522.0908">SamRevokedService getSamRevokedService()</text><polygon fill="#FFFF44" points="447.5,526.5078,451.5,530.5078,447.5,534.5078,443.5,530.5078" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="456.5" y="535.9268">PoHceService getPoHceService()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="549.7627"/><ellipse cx="447.5" cy="559.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="186" x="456.5" y="563.5986">loadProperties(Properties propertyFile)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="577.4346"/><polygon fill="#FFFF44" points="447.5,581.8516,451.5,585.8516,447.5,589.8516,443.5,585.8516" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="456.5" y="591.2705">ModificationMode getSessionModificationMode()</text><polygon fill="#FFFF44" points="447.5,595.6875,451.5,599.6875,447.5,603.6875,443.5,599.6875" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="456.5" y="605.1064">RatificationMode getSessionRatificationMode()</text><polygon fill="#FFFF44" points="447.5,609.5234,451.5,613.5234,447.5,617.5234,443.5,613.5234" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="456.5" y="618.9424">Byte getSessionDefaultKif(AccessLevel level)</text><polygon fill="#FFFF44" points="447.5,623.3594,451.5,627.3594,447.5,631.3594,443.5,627.3594" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="229" x="456.5" y="632.7783">Byte getSessionDefaultKvc(AccessLevel level)</text><polygon fill="#FFFF44" points="447.5,637.1953,451.5,641.1953,447.5,645.1953,443.5,641.1953" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="301" x="456.5" y="646.6143">Byte getSessionDefaultKeyRecordNumber(AccessLevel level)</text><polygon fill="#FFFF44" points="447.5,651.0313,451.5,655.0313,447.5,659.0313,443.5,655.0313" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="456.5" y="660.4502">Boolean isSessionKvcAuthorized(byte kvc)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="674.2861"/><polygon fill="#FFFF44" points="447.5,678.7031,451.5,682.7031,447.5,686.7031,443.5,682.7031" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="456.5" y="688.1221">PinTransmissionMode getPinTransmissionMode()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="459.5" y="701.958"/><polygon fill="#FFFF44" points="447.5,706.375,451.5,710.375,447.5,714.375,443.5,710.375" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="456.5" y="715.7939">LogRead getSvGetLogReadMode()</text><polygon fill="#FFFF44" points="447.5,720.2109,451.5,724.2109,447.5,728.2109,443.5,724.2109" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="456.5" y="729.6299">NegativeBalance getSvNegativeBalance()</text><polygon fill="#FFFF44" points="447.5,734.0469,451.5,738.0469,447.5,742.0469,443.5,738.0469" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="184" x="456.5" y="743.4658">Boolean isSvKvcAuthorized(byte kvc)</text><path d="M756.5,158.5 L756.5,208.5 L721.149,212.5 L756.5,216.5 L756.5,266.6094 A0,0 0 0 0 756.5,266.6094 L1189.5,266.6094 A0,0 0 0 0 1189.5,266.6094 L1189.5,168.5 L1179.5,158.5 L756.5,158.5 A0,0 0 0 0 756.5,158.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1179.5,158.5 L1179.5,168.5 L1189.5,168.5 L1179.5,158.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="405" x="762.5" y="176.9951">Default values in PoTransaction if PoSecuritySetting doesn't specify it:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="770.5" y="193.3467">- session ModificationMode as ATOMIC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="770.5" y="209.6982">- session RatificationMode as CLOSE_RATIFIED</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="360" x="770.5" y="226.0498">- PinTransmissionMode as ENCRYPTED if PoSecurity defined</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="770.5" y="242.4014">- any KIF/KVC values are authorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="404" x="770.5" y="258.7529">- no verification is done for: HCE token expiration, revoked PO or SAM</text><!--MD5=[8eb5cec01ad571a9feeff1db4f73a667]
class PoTransaction--><rect fill="#FEFECE" height="725.9609" id="PoTransaction" style="stroke: #D4AC0D; stroke-width: 1.5;" width="764" x="218" y="1170"/><ellipse cx="550.25" cy="1186" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M552.25,1182.5 Q552.4531,1182 552.6875,1181.75 Q552.9219,1181.5 553.1875,1181.5 Q553.6563,1181.5 553.9531,1181.7813 Q554.25,1182.0625 554.25,1182.7188 L554.25,1184.2813 Q554.25,1184.9375 553.9688,1185.2188 Q553.6875,1185.5 553.25,1185.5 Q552.8594,1185.5 552.6094,1185.3281 Q552.3594,1185.1563 552.25,1184.7031 Q552.2031,1184.3906 552.0313,1184.2188 Q551.7188,1183.8906 551.1563,1183.7031 Q550.5938,1183.5 550.0313,1183.5 Q549.3281,1183.5 548.7344,1183.7813 Q548.1563,1184.0625 547.7031,1184.6875 Q547.25,1185.3125 547.25,1186.1719 L547.25,1187.0938 Q547.25,1188.125 548.0938,1188.8125 Q548.9375,1189.5 550.4375,1189.5 Q551.3281,1189.5 551.9531,1189.2969 Q552.3125,1189.1875 552.7188,1188.8281 Q552.9844,1188.625 553.125,1188.5625 Q553.2656,1188.5 553.4375,1188.5 Q553.7656,1188.5 554,1188.7656 Q554.25,1189.0156 554.25,1189.375 Q554.25,1189.7188 553.9063,1190.125 Q553.4063,1190.7188 552.6094,1191.0469 Q551.5625,1191.5 550.2813,1191.5 Q548.7813,1191.5 547.5781,1190.9063 Q546.6094,1190.4375 545.9219,1189.4219 Q545.25,1188.4063 545.25,1187.2031 L545.25,1186.1094 Q545.25,1184.8594 545.8438,1183.7656 Q546.4531,1182.6719 547.5,1182.0938 Q548.5625,1181.5 549.75,1181.5 Q550.4688,1181.5 551.0938,1181.75 Q551.7188,1182 552.25,1182.5 Z "/><ellipse cx="575.75" cy="1185.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="581.75" y="1190.9102">PoTransaction</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="219" x2="981" y1="1202" y2="1202"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="219" x2="981" y1="1210" y2="1210"/><ellipse cx="229" cy="1221" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="388" x="238" y="1225.4189">PoTransaction(PoResource poResource, PoSecuritySetting[0..1] securitySetting)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="241" y="1239.2549"/><ellipse cx="229" cy="1248.6719" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1253.0908">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="264" y="1253.0908">prepareReleaseChannel()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="241" y="1266.9268"/><ellipse cx="229" cy="1276.3438" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1280.7627">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="264" y="1280.7627">processPoCommands()</text><ellipse cx="229" cy="1290.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1294.5986">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="177" x="264" y="1294.5986">processOpening(AccessLevel level)</text><ellipse cx="229" cy="1304.0156" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1308.4346">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="83" x="264" y="1308.4346">processClosing()</text><ellipse cx="229" cy="1317.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1322.2705">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="264" y="1322.2705">processCancel()</text><ellipse cx="229" cy="1331.6875" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1336.1064">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="398" x="264" y="1336.1064">prepareManageSession(EncryptionMode encMode, AuthenticationMode authMode)</text><ellipse cx="229" cy="1345.5234" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1349.9424">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="218" x="264" y="1349.9424">SessionSecureData getSessionSecureData()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="241" y="1363.7783"/><ellipse cx="229" cy="1373.1953" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1377.6143">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="264" y="1377.6143">prepareCheckPinStatus()</text><ellipse cx="229" cy="1387.0313" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1391.4502">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="264" y="1391.4502">processVerifyPin(String pin)</text><ellipse cx="229" cy="1400.8672" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1405.2861">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="264" y="1405.2861">processVerifyPin(byte[] pin)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="241" y="1419.1221"/><ellipse cx="229" cy="1428.5391" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1432.958">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="338" x="264" y="1432.958">prepareSvGet(SvSetting.Operation operation, SvSetting.Action action)</text><ellipse cx="229" cy="1442.375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1446.7939">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="278" x="264" y="1446.7939">prepareSvReload(int amount, int date, int time, String free)</text><ellipse cx="229" cy="1456.2109" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1460.6299">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="264" y="1460.6299">prepareSvReload(int amount, byte[] date, byte[] time, byte[] free)</text><ellipse cx="229" cy="1470.0469" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1474.4658">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="264" y="1474.4658">prepareSvReload(int amount)</text><ellipse cx="229" cy="1483.8828" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1488.3018">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="264" y="1488.3018">prepareSvDebit(int amount, int date, int time)</text><ellipse cx="229" cy="1497.7188" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1502.1377">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="244" x="264" y="1502.1377">prepareSvDebit(int amount, byte[] date, byte[] time)</text><ellipse cx="229" cy="1511.5547" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1515.9736">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="264" y="1515.9736">prepareSvDebit(int amount)</text><ellipse cx="229" cy="1525.3906" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1529.8096">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="260" x="264" y="1529.8096">SvOperationSecureData getSvOperationSecureData()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="241" y="1543.6455"/><ellipse cx="229" cy="1553.0625" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1557.4814">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="264" y="1557.4814">prepareSelectFile(short lid)</text><ellipse cx="229" cy="1566.8984" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1571.3174">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="264" y="1571.3174">prepareSelectFile(byte[] lid)</text><ellipse cx="229" cy="1580.7344" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1585.1533">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="208" x="264" y="1585.1533">prepareSelectFile(SelectFileControl control)</text><ellipse cx="229" cy="1594.5703" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1598.9893">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="247" x="264" y="1598.9893">prepareReadRecordFile(byte sfi, int recordNumber)</text><ellipse cx="229" cy="1608.4063" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1612.8252">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="455" x="264" y="1612.8252">prepareReadRecordFile(byte sfi, int firstRecordNumber, int numberOfRecords, int recordSize))</text><ellipse cx="229" cy="1622.2422" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1626.6611">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="559" x="264" y="1626.6611">prepareReadSubRecordFile(byte sfi, int firstRecordNumber, int numberOfRecord, int recordOffset, int recordLength)</text><ellipse cx="229" cy="1636.0781" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1640.4971">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="324" x="264" y="1640.4971">prepareReadBinaryFile(byte sfi, int dataLength, int[0..1] dataOffset)</text><ellipse cx="229" cy="1649.9141" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1654.333">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="261" x="264" y="1654.333">prepareReadCounterFile(byte sfi, int countersNumber)</text><ellipse cx="229" cy="1663.75" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1668.1689">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="264" y="1668.1689">prepareAppendRecord(byte sfi, byte[] recordData)</text><ellipse cx="229" cy="1677.5859" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1682.0049">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="330" x="264" y="1682.0049">prepareUpdateRecord(byte sfi, int recordNumber, byte[] recordData)</text><ellipse cx="229" cy="1691.4219" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1695.8408">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="321" x="264" y="1695.8408">prepareWriteRecord(byte sfi, int recordNumber, byte[] recordData)</text><ellipse cx="229" cy="1705.2578" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1709.6768">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="331" x="264" y="1709.6768">prepareUpdateBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)</text><ellipse cx="229" cy="1719.0938" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1723.5127">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="322" x="264" y="1723.5127">prepareWriteBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)</text><ellipse cx="229" cy="1732.9297" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1737.3486">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="318" x="264" y="1737.3486">prepareIncreaseCounter(byte sfi, int counterNumber, int incValue)</text><ellipse cx="229" cy="1746.7656" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1751.1846">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="327" x="264" y="1751.1846">prepareDecreaseCounter(byte sfi, int counterNumber, int decValue)</text><ellipse cx="229" cy="1760.6016" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1765.0205">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="264" y="1765.0205">prepareSetCounter(byte sfi, int counterNumber, int newValue)</text><ellipse cx="229" cy="1774.4375" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1778.8564">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="712" x="264" y="1778.8564">int prepareSearchRecord(byte sfi, byte offset, SearchOffsetMode offsetMode, byte[] searchData, Byte[] searchMask, SearchReadMode readMode)</text><ellipse cx="229" cy="1788.2734" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1792.6924">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="233" x="264" y="1792.6924">int[] getSearchResult(int searchRequestNumber)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="241" y="1806.5283"/><ellipse cx="229" cy="1815.9453" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1820.3643">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="264" y="1820.3643">prepareInvalidate()</text><ellipse cx="229" cy="1829.7813" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1834.2002">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="264" y="1834.2002">prepareRehabilitate()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="241" y="1848.0361"/><ellipse cx="229" cy="1857.4531" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1861.8721">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="264" y="1861.8721">prepareChangeKey(AccessLevel level)</text><ellipse cx="229" cy="1871.2891" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1875.708">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="142" x="264" y="1875.708">prepareChangePin(String pin)</text><ellipse cx="229" cy="1885.125" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="238" y="1889.5439">final</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="264" y="1889.5439">prepareChangePin(byte[] pin)</text><!--MD5=[2242c43c330acc437358859ea7f59776]
class SessionState--><rect fill="#FEFECE" height="89.5078" id="SessionState" style="stroke: #D4AC0D; stroke-width: 1.5;" width="125" x="459.5" y="1957"/><ellipse cx="478.1" cy="1973" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M476.6,1974 L476.6,1976 L480.6,1976 L480.6,1975 L480.6,1974.5156 L481.225,1974 L481.6,1974 L481.975,1974 L482.6,1974.5156 L482.6,1975 L482.6,1978 L474.6,1978 L474.1156,1978 L473.6,1977.375 L473.6,1977 L473.6,1976.625 L474.1156,1976 L474.6,1976 L474.6,1976 L474.6,1970 L474.6,1970 L474.1156,1970 L473.6,1969.375 L473.6,1969 L473.6,1968.625 L474.1156,1968 L474.6,1968 L482.6,1968 L482.6,1971 L482.6,1971.4844 L481.975,1972 L481.6,1972 L481.225,1972 L480.6,1971.4844 L480.6,1971 L480.6,1970 L476.6,1970 L476.6,1972 L477.6,1972 L477.6,1971.5156 L477.6,1971.5156 L478.225,1971 L478.6,1971 L478.975,1971 L479.6,1971.5156 L479.6,1972 L479.6,1974 L479.6,1974.4844 L478.975,1975 L478.975,1975 L478.6,1975 L478.225,1975 L477.6,1974.4844 L477.6,1974.4844 L477.6,1974 L476.6,1974 Z "/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="494.9" y="1969.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="503.9" y="1977.9102">SessionState</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460.5" x2="583.5" y1="1989" y2="1989"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="465.5" y="2004.4189">SESSION_UNITIALIZED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="465.5" y="2018.2549">SESSION_OPEN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="91" x="465.5" y="2032.0908">SESSION_CLOSED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460.5" x2="583.5" y1="2038.5078" y2="2038.5078"/><!--MD5=[bf7a0c1c8b34ad25b46528e084cfcf9f]
class SessionSetting--><rect fill="#FEFECE" height="48" id="SessionSetting" style="stroke: #D4AC0D; stroke-width: 1.5;" width="154" x="620" y="1978"/><ellipse cx="635" cy="1994" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M637,1990.5 Q637.2031,1990 637.4375,1989.75 Q637.6719,1989.5 637.9375,1989.5 Q638.4063,1989.5 638.7031,1989.7813 Q639,1990.0625 639,1990.7188 L639,1992.2813 Q639,1992.9375 638.7188,1993.2188 Q638.4375,1993.5 638,1993.5 Q637.6094,1993.5 637.3594,1993.3281 Q637.1094,1993.1563 637,1992.7031 Q636.9531,1992.3906 636.7813,1992.2188 Q636.4688,1991.8906 635.9063,1991.7031 Q635.3438,1991.5 634.7813,1991.5 Q634.0781,1991.5 633.4844,1991.7813 Q632.9063,1992.0625 632.4531,1992.6875 Q632,1993.3125 632,1994.1719 L632,1995.0938 Q632,1996.125 632.8438,1996.8125 Q633.6875,1997.5 635.1875,1997.5 Q636.0781,1997.5 636.7031,1997.2969 Q637.0625,1997.1875 637.4688,1996.8281 Q637.7344,1996.625 637.875,1996.5625 Q638.0156,1996.5 638.1875,1996.5 Q638.5156,1996.5 638.75,1996.7656 Q639,1997.0156 639,1997.375 Q639,1997.7188 638.6563,1998.125 Q638.1563,1998.7188 637.3594,1999.0469 Q636.3125,1999.5 635.0313,1999.5 Q633.5313,1999.5 632.3281,1998.9063 Q631.3594,1998.4375 630.6719,1997.4219 Q630,1996.4063 630,1995.2031 L630,1994.1094 Q630,1992.8594 630.5938,1991.7656 Q631.2031,1990.6719 632.25,1990.0938 Q633.3125,1989.5 634.5,1989.5 Q635.2188,1989.5 635.8438,1989.75 Q636.4688,1990 637,1990.5 Z "/><ellipse cx="654" cy="1993.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="660" y="1998.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="687" y="1998.9102">SessionSetting</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="621" x2="773" y1="2010" y2="2010"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="621" x2="773" y1="2018" y2="2018"/><!--MD5=[45c40070d26b32101cf9b7ab72916b9e]
class AccessLevel--><rect fill="#FEFECE" height="89.5078" id="AccessLevel" style="stroke: #D4AC0D; stroke-width: 1.5;" width="223" x="723.5" y="2247"/><ellipse cx="790.75" cy="2263" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M789.25,2264 L789.25,2266 L793.25,2266 L793.25,2265 L793.25,2264.5156 L793.875,2264 L794.25,2264 L794.625,2264 L795.25,2264.5156 L795.25,2265 L795.25,2268 L787.25,2268 L786.7656,2268 L786.25,2267.375 L786.25,2267 L786.25,2266.625 L786.7656,2266 L787.25,2266 L787.25,2266 L787.25,2260 L787.25,2260 L786.7656,2260 L786.25,2259.375 L786.25,2259 L786.25,2258.625 L786.7656,2258 L787.25,2258 L795.25,2258 L795.25,2261 L795.25,2261.4844 L794.625,2262 L794.25,2262 L793.875,2262 L793.25,2261.4844 L793.25,2261 L793.25,2260 L789.25,2260 L789.25,2262 L790.25,2262 L790.25,2261.5156 L790.25,2261.5156 L790.875,2261 L791.25,2261 L791.625,2261 L792.25,2261.5156 L792.25,2262 L792.25,2264 L792.25,2264.4844 L791.625,2265 L791.625,2265 L791.25,2265 L790.875,2265 L790.25,2264.4844 L790.25,2264.4844 L790.25,2264 L789.25,2264 Z "/><ellipse cx="816.25" cy="2262.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="822.25" y="2267.9102">AccessLevel</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="724.5" x2="945.5" y1="2279" y2="2279"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="724.5" x2="945.5" y1="2287" y2="2287"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="729.5" y="2302.4189">SESSION_LVL_PERSO("perso", byte 0x01),</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="198" x="729.5" y="2316.2549">SESSION_LVL_LOAD("load", byte 0x02),</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="197" x="729.5" y="2330.0908">SESSION_LVL_DEBIT("debit", byte 0x03)</text><!--MD5=[e19a48d2c11a8f9a6a11f4ef9a7d8d18]
class ModificationMode--><rect fill="#FEFECE" height="75.6719" id="ModificationMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="138" x="459" y="2108"/><ellipse cx="474" cy="2124" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M472.5,2125 L472.5,2127 L476.5,2127 L476.5,2126 L476.5,2125.5156 L477.125,2125 L477.5,2125 L477.875,2125 L478.5,2125.5156 L478.5,2126 L478.5,2129 L470.5,2129 L470.0156,2129 L469.5,2128.375 L469.5,2128 L469.5,2127.625 L470.0156,2127 L470.5,2127 L470.5,2127 L470.5,2121 L470.5,2121 L470.0156,2121 L469.5,2120.375 L469.5,2120 L469.5,2119.625 L470.0156,2119 L470.5,2119 L478.5,2119 L478.5,2122 L478.5,2122.4844 L477.875,2123 L477.5,2123 L477.125,2123 L476.5,2122.4844 L476.5,2122 L476.5,2121 L472.5,2121 L472.5,2123 L473.5,2123 L473.5,2122.5156 L473.5,2122.5156 L474.125,2122 L474.5,2122 L474.875,2122 L475.5,2122.5156 L475.5,2123 L475.5,2125 L475.5,2125.4844 L474.875,2126 L474.875,2126 L474.5,2126 L474.125,2126 L473.5,2125.4844 L473.5,2125.4844 L473.5,2125 L472.5,2125 Z "/><ellipse cx="493" cy="2123.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="499" y="2128.9102">ModificationMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460" x2="596" y1="2140" y2="2140"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="465" y="2155.4189">ATOMIC,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="465" y="2169.2549">MULTIPLE</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="460" x2="596" y1="2175.6719" y2="2175.6719"/><!--MD5=[139c679d0f2db6318e7e57d2f6dd7d7b]
class RatificationMode--><rect fill="#FEFECE" height="75.6719" id="RatificationMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="134" x="871" y="2108"/><ellipse cx="886" cy="2124" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M884.5,2125 L884.5,2127 L888.5,2127 L888.5,2126 L888.5,2125.5156 L889.125,2125 L889.5,2125 L889.875,2125 L890.5,2125.5156 L890.5,2126 L890.5,2129 L882.5,2129 L882.0156,2129 L881.5,2128.375 L881.5,2128 L881.5,2127.625 L882.0156,2127 L882.5,2127 L882.5,2127 L882.5,2121 L882.5,2121 L882.0156,2121 L881.5,2120.375 L881.5,2120 L881.5,2119.625 L882.0156,2119 L882.5,2119 L890.5,2119 L890.5,2122 L890.5,2122.4844 L889.875,2123 L889.5,2123 L889.125,2123 L888.5,2122.4844 L888.5,2122 L888.5,2121 L884.5,2121 L884.5,2123 L885.5,2123 L885.5,2122.5156 L885.5,2122.5156 L886.125,2122 L886.5,2122 L886.875,2122 L887.5,2122.5156 L887.5,2123 L887.5,2125 L887.5,2125.4844 L886.875,2126 L886.875,2126 L886.5,2126 L886.125,2126 L885.5,2125.4844 L885.5,2125.4844 L885.5,2125 L884.5,2125 Z "/><ellipse cx="905" cy="2123.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="911" y="2128.9102">RatificationMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="872" x2="1004" y1="2140" y2="2140"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="877" y="2155.4189">CLOSE_RATIFIED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="877" y="2169.2549">CLOSE_NOT_RATIFIED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="872" x2="1004" y1="2175.6719" y2="2175.6719"/><!--MD5=[ce8182edd4590e04a2102797ac389b3e]
class EncryptionMode--><rect fill="#FEFECE" height="75.6719" id="EncryptionMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="130" x="669" y="2108"/><ellipse cx="684" cy="2124" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M682.5,2125 L682.5,2127 L686.5,2127 L686.5,2126 L686.5,2125.5156 L687.125,2125 L687.5,2125 L687.875,2125 L688.5,2125.5156 L688.5,2126 L688.5,2129 L680.5,2129 L680.0156,2129 L679.5,2128.375 L679.5,2128 L679.5,2127.625 L680.0156,2127 L680.5,2127 L680.5,2127 L680.5,2121 L680.5,2121 L680.0156,2121 L679.5,2120.375 L679.5,2120 L679.5,2119.625 L680.0156,2119 L680.5,2119 L688.5,2119 L688.5,2122 L688.5,2122.4844 L687.875,2123 L687.5,2123 L687.125,2123 L686.5,2122.4844 L686.5,2122 L686.5,2121 L682.5,2121 L682.5,2123 L683.5,2123 L683.5,2122.5156 L683.5,2122.5156 L684.125,2122 L684.5,2122 L684.875,2122 L685.5,2122.5156 L685.5,2123 L685.5,2125 L685.5,2125.4844 L684.875,2126 L684.875,2126 L684.5,2126 L684.125,2126 L683.5,2125.4844 L683.5,2125.4844 L683.5,2125 L682.5,2125 Z "/><ellipse cx="703" cy="2123.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="709" y="2128.9102">EncryptionMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="670" x2="798" y1="2140" y2="2140"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="54" x="675" y="2155.4189">ACTIVATE,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="675" y="2169.2549">DEACTIVATE</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="670" x2="798" y1="2175.6719" y2="2175.6719"/><!--MD5=[587c29523c7e651cb28d7191d1daa746]
class AuthenticationMode--><rect fill="#FEFECE" height="75.6719" id="AuthenticationMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="150" x="538" y="2254"/><ellipse cx="553" cy="2270" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M551.5,2271 L551.5,2273 L555.5,2273 L555.5,2272 L555.5,2271.5156 L556.125,2271 L556.5,2271 L556.875,2271 L557.5,2271.5156 L557.5,2272 L557.5,2275 L549.5,2275 L549.0156,2275 L548.5,2274.375 L548.5,2274 L548.5,2273.625 L549.0156,2273 L549.5,2273 L549.5,2273 L549.5,2267 L549.5,2267 L549.0156,2267 L548.5,2266.375 L548.5,2266 L548.5,2265.625 L549.0156,2265 L549.5,2265 L557.5,2265 L557.5,2268 L557.5,2268.4844 L556.875,2269 L556.5,2269 L556.125,2269 L555.5,2268.4844 L555.5,2268 L555.5,2267 L551.5,2267 L551.5,2269 L552.5,2269 L552.5,2268.5156 L552.5,2268.5156 L553.125,2268 L553.5,2268 L553.875,2268 L554.5,2268.5156 L554.5,2269 L554.5,2271 L554.5,2271.4844 L553.875,2272 L553.875,2272 L553.5,2272 L553.125,2272 L552.5,2271.4844 L552.5,2271.4844 L552.5,2271 L551.5,2271 Z "/><ellipse cx="572" cy="2269.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="107" x="578" y="2274.9102">AuthenticationMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="539" x2="687" y1="2286" y2="2286"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="544" y="2301.4189">REQUESTED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="544" y="2315.2549">NOT_REQUESTED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="539" x2="687" y1="2321.6719" y2="2321.6719"/><!--MD5=[69e7de8796175c80a787a8fe6d04a077]
class PinTransmissionMode--><rect fill="#FEFECE" height="75.6719" id="PinTransmissionMode" style="stroke: #D4AC0D; stroke-width: 1.5;" width="168" x="809" y="1964"/><ellipse cx="824" cy="1980" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M822.5,1981 L822.5,1983 L826.5,1983 L826.5,1982 L826.5,1981.5156 L827.125,1981 L827.5,1981 L827.875,1981 L828.5,1981.5156 L828.5,1982 L828.5,1985 L820.5,1985 L820.0156,1985 L819.5,1984.375 L819.5,1984 L819.5,1983.625 L820.0156,1983 L820.5,1983 L820.5,1983 L820.5,1977 L820.5,1977 L820.0156,1977 L819.5,1976.375 L819.5,1976 L819.5,1975.625 L820.0156,1975 L820.5,1975 L828.5,1975 L828.5,1978 L828.5,1978.4844 L827.875,1979 L827.5,1979 L827.125,1979 L826.5,1978.4844 L826.5,1978 L826.5,1977 L822.5,1977 L822.5,1979 L823.5,1979 L823.5,1978.5156 L823.5,1978.5156 L824.125,1978 L824.5,1978 L824.875,1978 L825.5,1978.5156 L825.5,1979 L825.5,1981 L825.5,1981.4844 L824.875,1982 L824.875,1982 L824.5,1982 L824.125,1982 L823.5,1981.4844 L823.5,1981.4844 L823.5,1981 L822.5,1981 Z "/><ellipse cx="843" cy="1979.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="125" x="849" y="1984.9102">PinTransmissionMode</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="810" x2="976" y1="1996" y2="1996"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="815" y="2011.4189">PLAIN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="815" y="2025.2549">ENCRYPTED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="810" x2="976" y1="2031.6719" y2="2031.6719"/><!--MD5=[80e74f8fe2d788e9d347a51040ef83af]
class SamRevokedService--><rect fill="#FEFECE" height="61.8359" id="SamRevokedService" style="stroke: #D4AC0D; stroke-width: 1.5;" width="367" x="798.5" y="563.5"/><ellipse cx="913.75" cy="579.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #B4A7E5; stroke-width: 1.0;"/><path d="M914.75,576.5 L914.75,582.5 L916.75,582.5 L917.2344,582.5 L917.75,583.125 L917.75,583.5 L917.75,583.875 L917.2344,584.5 L916.75,584.5 L910.75,584.5 L910.2656,584.5 L909.75,583.875 L909.75,583.5 L909.75,583.125 L910.2656,582.5 L910.75,582.5 L912.75,582.5 L912.75,576.5 L910.75,576.5 L910.2656,576.5 L909.75,575.875 L909.75,575.5 L909.75,575.125 L910.2656,574.5 L910.75,574.5 L916.75,574.5 L917.2344,574.5 L917.75,575.125 L917.75,575.5 L917.75,575.875 L917.2344,576.5 L916.75,576.5 L914.75,576.5 Z "/><ellipse cx="939.25" cy="579" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="117" x="945.25" y="584.4102">SamRevokedService</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="799.5" x2="1164.5" y1="595.5" y2="595.5"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="799.5" x2="1164.5" y1="603.5" y2="603.5"/><ellipse cx="809.5" cy="614.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="341" x="818.5" y="618.9189">boolean isSamRevoked(byte[] 4bytesSerial, byte[][0..1] 3bytesCounter)</text><!--MD5=[43918d86839edc1befb88ea50efcfbfb]
class SamResource--><rect fill="#FEFECE" height="75.6719" id="SamResource" style="stroke: #D4AC0D; stroke-width: 1.5;" width="191" x="842.5" y="811"/><ellipse cx="859.3" cy="827" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M861.3,823.5 Q861.5031,823 861.7375,822.75 Q861.9719,822.5 862.2375,822.5 Q862.7063,822.5 863.0031,822.7813 Q863.3,823.0625 863.3,823.7188 L863.3,825.2813 Q863.3,825.9375 863.0188,826.2188 Q862.7375,826.5 862.3,826.5 Q861.9094,826.5 861.6594,826.3281 Q861.4094,826.1563 861.3,825.7031 Q861.2531,825.3906 861.0813,825.2188 Q860.7688,824.8906 860.2063,824.7031 Q859.6438,824.5 859.0813,824.5 Q858.3781,824.5 857.7844,824.7813 Q857.2063,825.0625 856.7531,825.6875 Q856.3,826.3125 856.3,827.1719 L856.3,828.0938 Q856.3,829.125 857.1438,829.8125 Q857.9875,830.5 859.4875,830.5 Q860.3781,830.5 861.0031,830.2969 Q861.3625,830.1875 861.7688,829.8281 Q862.0344,829.625 862.175,829.5625 Q862.3156,829.5 862.4875,829.5 Q862.8156,829.5 863.05,829.7656 Q863.3,830.0156 863.3,830.375 Q863.3,830.7188 862.9563,831.125 Q862.4563,831.7188 861.6594,832.0469 Q860.6125,832.5 859.3313,832.5 Q857.8313,832.5 856.6281,831.9063 Q855.6594,831.4375 854.9719,830.4219 Q854.3,829.4063 854.3,828.2031 L854.3,827.1094 Q854.3,825.8594 854.8938,824.7656 Q855.5031,823.6719 856.55,823.0938 Q857.6125,822.5 858.8,822.5 Q859.5188,822.5 860.1438,822.75 Q860.7688,823 861.3,823.5 Z "/><ellipse cx="878.7" cy="826.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="884.7" y="831.9102">SeResource</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="73" x="963.5" y="808"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="71" x="964.5" y="821.457">CalypsoSam</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="843.5" x2="1032.5" y1="843" y2="843"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="843.5" x2="1032.5" y1="851" y2="851"/><ellipse cx="853.5" cy="862" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="862.5" y="866.4189">SeResource(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="926.5" y="866.4189">SeReader seReader</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="3" x="1024.5" y="866.4189">,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="862.5" y="880.2549">CalypsoSam sam);</text><!--MD5=[f25ff1fa8fa59bbc0543eaadeb7d653a]
class CalypsoSam--><rect fill="#FEFECE" height="158.6875" id="CalypsoSam" style="stroke: #D4AC0D; stroke-width: 1.5;" width="251" x="812.5" y="948"/><ellipse cx="879.25" cy="964" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M881.25,960.5 Q881.4531,960 881.6875,959.75 Q881.9219,959.5 882.1875,959.5 Q882.6563,959.5 882.9531,959.7813 Q883.25,960.0625 883.25,960.7188 L883.25,962.2813 Q883.25,962.9375 882.9688,963.2188 Q882.6875,963.5 882.25,963.5 Q881.8594,963.5 881.6094,963.3281 Q881.3594,963.1563 881.25,962.7031 Q881.2031,962.3906 881.0313,962.2188 Q880.7188,961.8906 880.1563,961.7031 Q879.5938,961.5 879.0313,961.5 Q878.3281,961.5 877.7344,961.7813 Q877.1563,962.0625 876.7031,962.6875 Q876.25,963.3125 876.25,964.1719 L876.25,965.0938 Q876.25,966.125 877.0938,966.8125 Q877.9375,967.5 879.4375,967.5 Q880.3281,967.5 880.9531,967.2969 Q881.3125,967.1875 881.7188,966.8281 Q881.9844,966.625 882.125,966.5625 Q882.2656,966.5 882.4375,966.5 Q882.7656,966.5 883,966.7656 Q883.25,967.0156 883.25,967.375 Q883.25,967.7188 882.9063,968.125 Q882.4063,968.7188 881.6094,969.0469 Q880.5625,969.5 879.2813,969.5 Q877.7813,969.5 876.5781,968.9063 Q875.6094,968.4375 874.9219,967.4219 Q874.25,966.4063 874.25,965.2031 L874.25,964.1094 Q874.25,962.8594 874.8438,961.7656 Q875.4531,960.6719 876.5,960.0938 Q877.5625,959.5 878.75,959.5 Q879.4688,959.5 880.0938,959.75 Q880.7188,960 881.25,960.5 Z "/><ellipse cx="904.75" cy="963.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="910.75" y="968.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="937.75" y="968.9102">CalypsoSam</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="813.5" x2="1062.5" y1="980" y2="980"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="813.5" x2="1062.5" y1="988" y2="988"/><polygon fill="#4177AF" points="823.5,995,819.5,1001,827.5,1001" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="832.5" y="1003.4189">CalypsoSam(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="896.5" y="1003.4189">SeResponse selectionResponse</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="4" x="1053.5" y="1003.4189">)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="835.5" y="1017.2549"/><ellipse cx="823.5" cy="1026.6719" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="832.5" y="1031.0908">SamRevision getSamRevision()</text><ellipse cx="823.5" cy="1040.5078" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="832.5" y="1044.9268">byte[] getSerialNumber()</text><ellipse cx="823.5" cy="1054.3438" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="832.5" y="1058.7627">byte getPlatform()</text><ellipse cx="823.5" cy="1068.1797" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="832.5" y="1072.5986">byte getApplicationType()</text><ellipse cx="823.5" cy="1082.0156" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="832.5" y="1086.4346">byte getApplicationSubType()</text><ellipse cx="823.5" cy="1095.8516" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="832.5" y="1100.2705">byte getSoftwareIssuer()</text><!--MD5=[2296a6a537aebb6d062261368584c4c8]
class PoRevokedService--><rect fill="#FEFECE" height="61.8359" id="PoRevokedService" style="stroke: #D4AC0D; stroke-width: 1.5;" width="227" x="163.5" y="563.5"/><ellipse cx="214.25" cy="579.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #B4A7E5; stroke-width: 1.0;"/><path d="M215.25,576.5 L215.25,582.5 L217.25,582.5 L217.7344,582.5 L218.25,583.125 L218.25,583.5 L218.25,583.875 L217.7344,584.5 L217.25,584.5 L211.25,584.5 L210.7656,584.5 L210.25,583.875 L210.25,583.5 L210.25,583.125 L210.7656,582.5 L211.25,582.5 L213.25,582.5 L213.25,576.5 L211.25,576.5 L210.7656,576.5 L210.25,575.875 L210.25,575.5 L210.25,575.125 L210.7656,574.5 L211.25,574.5 L217.25,574.5 L217.7344,574.5 L218.25,575.125 L218.25,575.5 L218.25,575.875 L217.7344,576.5 L217.25,576.5 L215.25,576.5 Z "/><ellipse cx="239.75" cy="579" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="106" x="245.75" y="584.4102">PoRevokedService</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="164.5" x2="389.5" y1="595.5" y2="595.5"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="164.5" x2="389.5" y1="603.5" y2="603.5"/><ellipse cx="174.5" cy="614.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="183.5" y="618.9189">boolean isPoRevoked(byte[] 8bytesSerial)</text><!--MD5=[1ac61061803296a84828c176919fd8e8]
class PoHceService--><rect fill="#FEFECE" height="61.8359" id="PoHceService" style="stroke: #D4AC0D; stroke-width: 1.5;" width="317" x="86.5" y="818"/><ellipse cx="196.25" cy="834" fill="#B4A7E5" rx="11" ry="11" style="stroke: #B4A7E5; stroke-width: 1.0;"/><path d="M197.25,831 L197.25,837 L199.25,837 L199.7344,837 L200.25,837.625 L200.25,838 L200.25,838.375 L199.7344,839 L199.25,839 L193.25,839 L192.7656,839 L192.25,838.375 L192.25,838 L192.25,837.625 L192.7656,837 L193.25,837 L195.25,837 L195.25,831 L193.25,831 L192.7656,831 L192.25,830.375 L192.25,830 L192.25,829.625 L192.7656,829 L193.25,829 L199.25,829 L199.7344,829 L200.25,829.625 L200.25,830 L200.25,830.375 L199.7344,831 L199.25,831 L197.25,831 Z "/><ellipse cx="221.75" cy="833.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="78" x="227.75" y="838.9102">PoHceService</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="402.5" y1="850" y2="850"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="402.5" y1="858" y2="858"/><ellipse cx="97.5" cy="869" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="291" x="106.5" y="873.4189">boolean isCalypsoSerialExpired(byte[] 2bytesExpirationData)</text><!--MD5=[e8e21ba3995782366e9aa9ad2c6b2d5f]
class PoResource--><rect fill="#FEFECE" height="75.6719" id="PoResource" style="stroke: #D4AC0D; stroke-width: 1.5;" width="191" x="181.5" y="989.5"/><ellipse cx="203.25" cy="1005.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M205.25,1002 Q205.4531,1001.5 205.6875,1001.25 Q205.9219,1001 206.1875,1001 Q206.6563,1001 206.9531,1001.2813 Q207.25,1001.5625 207.25,1002.2188 L207.25,1003.7813 Q207.25,1004.4375 206.9688,1004.7188 Q206.6875,1005 206.25,1005 Q205.8594,1005 205.6094,1004.8281 Q205.3594,1004.6563 205.25,1004.2031 Q205.2031,1003.8906 205.0313,1003.7188 Q204.7188,1003.3906 204.1563,1003.2031 Q203.5938,1003 203.0313,1003 Q202.3281,1003 201.7344,1003.2813 Q201.1563,1003.5625 200.7031,1004.1875 Q200.25,1004.8125 200.25,1005.6719 L200.25,1006.5938 Q200.25,1007.625 201.0938,1008.3125 Q201.9375,1009 203.4375,1009 Q204.3281,1009 204.9531,1008.7969 Q205.3125,1008.6875 205.7188,1008.3281 Q205.9844,1008.125 206.125,1008.0625 Q206.2656,1008 206.4375,1008 Q206.7656,1008 207,1008.2656 Q207.25,1008.5156 207.25,1008.875 Q207.25,1009.2188 206.9063,1009.625 Q206.4063,1010.2188 205.6094,1010.5469 Q204.5625,1011 203.2813,1011 Q201.7813,1011 200.5781,1010.4063 Q199.6094,1009.9375 198.9219,1008.9219 Q198.25,1007.9063 198.25,1006.7031 L198.25,1005.6094 Q198.25,1004.3594 198.8438,1003.2656 Q199.4531,1002.1719 200.5,1001.5938 Q201.5625,1001 202.75,1001 Q203.4688,1001 204.0938,1001.25 Q204.7188,1001.5 205.25,1002 Z "/><ellipse cx="223.75" cy="1005" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="229.75" y="1010.4102">SeResource</text><rect fill="#FFFFFF" height="17.0938" style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" width="62" x="313.5" y="986.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="60" x="314.5" y="999.957">CalypsoPo</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="182.5" x2="371.5" y1="1021.5" y2="1021.5"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="182.5" x2="371.5" y1="1029.5" y2="1029.5"/><ellipse cx="192.5" cy="1040.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="201.5" y="1044.9189">SeResource(</text><text fill="#FF0000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="265.5" y="1044.9189">SeReader seReader</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="3" x="363.5" y="1044.9189">,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="73" x="201.5" y="1058.7549">CalypsoPo po);</text><!--MD5=[7d16591ce1ac0fb103d5c2b0f24533d6]
class SvSetting--><rect fill="#FEFECE" height="48" id="SvSetting" style="stroke: #D4AC0D; stroke-width: 1.5;" width="121" x="131.5" y="1978"/><ellipse cx="146.5" cy="1994" fill="#ADD1B2" rx="11" ry="11" style="stroke: #ADD1B2; stroke-width: 1.0;"/><path d="M148.5,1990.5 Q148.7031,1990 148.9375,1989.75 Q149.1719,1989.5 149.4375,1989.5 Q149.9063,1989.5 150.2031,1989.7813 Q150.5,1990.0625 150.5,1990.7188 L150.5,1992.2813 Q150.5,1992.9375 150.2188,1993.2188 Q149.9375,1993.5 149.5,1993.5 Q149.1094,1993.5 148.8594,1993.3281 Q148.6094,1993.1563 148.5,1992.7031 Q148.4531,1992.3906 148.2813,1992.2188 Q147.9688,1991.8906 147.4063,1991.7031 Q146.8438,1991.5 146.2813,1991.5 Q145.5781,1991.5 144.9844,1991.7813 Q144.4063,1992.0625 143.9531,1992.6875 Q143.5,1993.3125 143.5,1994.1719 L143.5,1995.0938 Q143.5,1996.125 144.3438,1996.8125 Q145.1875,1997.5 146.6875,1997.5 Q147.5781,1997.5 148.2031,1997.2969 Q148.5625,1997.1875 148.9688,1996.8281 Q149.2344,1996.625 149.375,1996.5625 Q149.5156,1996.5 149.6875,1996.5 Q150.0156,1996.5 150.25,1996.7656 Q150.5,1997.0156 150.5,1997.375 Q150.5,1997.7188 150.1563,1998.125 Q149.6563,1998.7188 148.8594,1999.0469 Q147.8125,1999.5 146.5313,1999.5 Q145.0313,1999.5 143.8281,1998.9063 Q142.8594,1998.4375 142.1719,1997.4219 Q141.5,1996.4063 141.5,1995.2031 L141.5,1994.1094 Q141.5,1992.8594 142.0938,1991.7656 Q142.7031,1990.6719 143.75,1990.0938 Q144.8125,1989.5 146,1989.5 Q146.7188,1989.5 147.3438,1989.75 Q147.9688,1990 148.5,1990.5 Z "/><ellipse cx="165.5" cy="1993.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="171.5" y="1998.9102">final</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="198.5" y="1998.9102">SvSetting</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="132.5" x2="251.5" y1="2010" y2="2010"/><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="132.5" x2="251.5" y1="2018" y2="2018"/><!--MD5=[cca5d97aaf46870920fae66c9bd85cdd]
class Operation--><rect fill="#FEFECE" height="75.6719" id="Operation" style="stroke: #D4AC0D; stroke-width: 1.5;" width="97" x="86.5" y="2108"/><ellipse cx="101.5" cy="2124" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M100,2125 L100,2127 L104,2127 L104,2126 L104,2125.5156 L104.625,2125 L105,2125 L105.375,2125 L106,2125.5156 L106,2126 L106,2129 L98,2129 L97.5156,2129 L97,2128.375 L97,2128 L97,2127.625 L97.5156,2127 L98,2127 L98,2127 L98,2121 L98,2121 L97.5156,2121 L97,2120.375 L97,2120 L97,2119.625 L97.5156,2119 L98,2119 L106,2119 L106,2122 L106,2122.4844 L105.375,2123 L105,2123 L104.625,2123 L104,2122.4844 L104,2122 L104,2121 L100,2121 L100,2123 L101,2123 L101,2122.5156 L101,2122.5156 L101.625,2122 L102,2122 L102.375,2122 L103,2122.5156 L103,2123 L103,2125 L103,2125.4844 L102.375,2126 L102.375,2126 L102,2126 L101.625,2126 L101,2125.4844 L101,2125.4844 L101,2125 L100,2125 Z "/><ellipse cx="120.5" cy="2123.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="54" x="126.5" y="2128.9102">Operation</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="182.5" y1="2140" y2="2140"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="92.5" y="2155.4189">RELOAD,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="92.5" y="2169.2549">DEBIT</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="87.5" x2="182.5" y1="2175.6719" y2="2175.6719"/><!--MD5=[f8e7078f77c005d15b486c0c98deb1e6]
class Action--><rect fill="#FEFECE" height="75.6719" id="Action" style="stroke: #D4AC0D; stroke-width: 1.5;" width="76" x="219" y="2108"/><ellipse cx="234" cy="2124" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M232.5,2125 L232.5,2127 L236.5,2127 L236.5,2126 L236.5,2125.5156 L237.125,2125 L237.5,2125 L237.875,2125 L238.5,2125.5156 L238.5,2126 L238.5,2129 L230.5,2129 L230.0156,2129 L229.5,2128.375 L229.5,2128 L229.5,2127.625 L230.0156,2127 L230.5,2127 L230.5,2127 L230.5,2121 L230.5,2121 L230.0156,2121 L229.5,2120.375 L229.5,2120 L229.5,2119.625 L230.0156,2119 L230.5,2119 L238.5,2119 L238.5,2122 L238.5,2122.4844 L237.875,2123 L237.5,2123 L237.125,2123 L236.5,2122.4844 L236.5,2122 L236.5,2121 L232.5,2121 L232.5,2123 L233.5,2123 L233.5,2122.5156 L233.5,2122.5156 L234.125,2122 L234.5,2122 L234.875,2122 L235.5,2122.5156 L235.5,2123 L235.5,2125 L235.5,2125.4844 L234.875,2126 L234.875,2126 L234.5,2126 L234.125,2126 L233.5,2125.4844 L233.5,2125.4844 L233.5,2125 L232.5,2125 Z "/><ellipse cx="253" cy="2123.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="33" x="259" y="2128.9102">Action</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="220" x2="294" y1="2140" y2="2140"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="225" y="2155.4189">DO,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="29" x="225" y="2169.2549">UNDO</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="220" x2="294" y1="2175.6719" y2="2175.6719"/><!--MD5=[67d91b3e56e3fb89140abbb352fa8438]
class LogRead--><rect fill="#FEFECE" height="75.6719" id="LogRead" style="stroke: #D4AC0D; stroke-width: 1.5;" width="94" x="330" y="2108"/><ellipse cx="345" cy="2124" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M343.5,2125 L343.5,2127 L347.5,2127 L347.5,2126 L347.5,2125.5156 L348.125,2125 L348.5,2125 L348.875,2125 L349.5,2125.5156 L349.5,2126 L349.5,2129 L341.5,2129 L341.0156,2129 L340.5,2128.375 L340.5,2128 L340.5,2127.625 L341.0156,2127 L341.5,2127 L341.5,2127 L341.5,2121 L341.5,2121 L341.0156,2121 L340.5,2120.375 L340.5,2120 L340.5,2119.625 L341.0156,2119 L341.5,2119 L349.5,2119 L349.5,2122 L349.5,2122.4844 L348.875,2123 L348.5,2123 L348.125,2123 L347.5,2122.4844 L347.5,2122 L347.5,2121 L343.5,2121 L343.5,2123 L344.5,2123 L344.5,2122.5156 L344.5,2122.5156 L345.125,2122 L345.5,2122 L345.875,2122 L346.5,2122.5156 L346.5,2123 L346.5,2125 L346.5,2125.4844 L345.875,2126 L345.875,2126 L345.5,2126 L345.125,2126 L344.5,2125.4844 L344.5,2125.4844 L344.5,2125 L343.5,2125 Z "/><ellipse cx="364" cy="2123.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="370" y="2128.9102">LogRead</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="331" x2="423" y1="2140" y2="2140"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="336" y="2155.4189">SINGLE,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="336" y="2169.2549">ALL</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="331" x2="423" y1="2175.6719" y2="2175.6719"/><!--MD5=[50d6b8eba543a732d1dd3c761d982397]
class NegativeBalance--><rect fill="#FEFECE" height="75.6719" id="NegativeBalance" style="stroke: #D4AC0D; stroke-width: 1.5;" width="136" x="288" y="1964"/><ellipse cx="303" cy="1980" fill="#EB937F" rx="11" ry="11" style="stroke: #EB93DF; stroke-width: 1.0;"/><path d="M301.5,1981 L301.5,1983 L305.5,1983 L305.5,1982 L305.5,1981.5156 L306.125,1981 L306.5,1981 L306.875,1981 L307.5,1981.5156 L307.5,1982 L307.5,1985 L299.5,1985 L299.0156,1985 L298.5,1984.375 L298.5,1984 L298.5,1983.625 L299.0156,1983 L299.5,1983 L299.5,1983 L299.5,1977 L299.5,1977 L299.0156,1977 L298.5,1976.375 L298.5,1976 L298.5,1975.625 L299.0156,1975 L299.5,1975 L307.5,1975 L307.5,1978 L307.5,1978.4844 L306.875,1979 L306.5,1979 L306.125,1979 L305.5,1978.4844 L305.5,1978 L305.5,1977 L301.5,1977 L301.5,1979 L302.5,1979 L302.5,1978.5156 L302.5,1978.5156 L303.125,1978 L303.5,1978 L303.875,1978 L304.5,1978.5156 L304.5,1979 L304.5,1981 L304.5,1981.4844 L303.875,1982 L303.875,1982 L303.5,1982 L303.125,1982 L302.5,1981.4844 L302.5,1981.4844 L302.5,1981 L301.5,1981 Z "/><ellipse cx="322" cy="1979.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="93" x="328" y="1984.9102">NegativeBalance</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="289" x2="423" y1="1996" y2="1996"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="294" y="2011.4189">FORBIDDEN,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="294" y="2025.2549">AUTHORIZED</text><line style="stroke: #D4AC0D; stroke-width: 1.5;" x1="289" x2="423" y1="2031.6719" y2="2031.6719"/><!--MD5=[b5831fe2f38c217483a231289f3a8748]
link PoSecuritySettingBuilder to PoSecuritySetting--><path d="M525.43,361.23 C533.597,386.67 542.106,413.17 550.33,438.79 " fill="none" id="PoSecuritySettingBuilder-PoSecuritySetting" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="540" y="405.4951">build</text><polygon fill="#000000" points="549,414.3516,552,420.3516,555,414.3516,549,414.3516" style="stroke: #000000; stroke-width: 1.0;"/><!--MD5=[5d6d67a6e099206d95b683be9999b9cd]
reverse link PoSecuritySetting to SamRevokedService--><path d="M776.984,594.5 C784.087,594.5 791.19,594.5 798.293,594.5 " fill="none" id="PoSecuritySetting&lt;-SamRevokedService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="763.768,594.5,769.768,598.5,775.768,594.5,769.768,590.5,763.768,594.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="771.3473" y="591.6432">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="768.6873" y="591.6927">0..1</text><!--MD5=[a40139effe78355afd96e1fe38f816a4]
reverse link PoSecuritySetting to SamResource--><path d="M773.964,744.05 C776.651,746.06 779.331,748.04 782,750 C811.411,771.55 845.563,793.34 874.402,810.89 " fill="none" id="PoSecuritySetting&lt;-SamResource" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="763.57,736.19,765.9431,742.9994,773.1414,743.4279,770.7684,736.6185,763.57,736.19" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="771.7593" y="740.1721">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="838.758" y="800.2323">0..1</text><!--MD5=[df9e65eec241e7a0900f3f2cc1715dea]
link SamRevokedService to SamResource--><!--MD5=[f5f07a045c16f9b5b991b6ad223e4b75]
reverse link SamResource to CalypsoSam--><path d="M938,900.07 C938,914.91 938,931.54 938,947.74 " fill="none" id="SamResource&lt;-CalypsoSam" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="938,887,934,893,938,899,942,893,938,887" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="930.4203" y="908.1702">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="930.6773" y="937.1754">1</text><!--MD5=[4887dba8439a7c195496dbe34ec42e74]
reverse link PoSecuritySetting to PoRevokedService--><path d="M423.127,594.5 C412.27,594.5 401.412,594.5 390.555,594.5 " fill="none" id="PoSecuritySetting&lt;-PoRevokedService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="436.371,594.5,430.371,590.5,424.371,594.5,430.371,598.5,436.371,594.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="421.2757" y="591.619">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="398.5343" y="591.4991">0..1</text><!--MD5=[c7931a5b3688f34377874a4d447492d9]
reverse link PoSecuritySetting to PoHceService--><path d="M425.579,746.06 C423.717,747.39 421.857,748.7 420,750 C383.607,775.43 340.056,799.84 305.504,817.93 " fill="none" id="PoSecuritySetting&lt;-PoHceService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="436.263,738.31,429.0575,738.5932,426.5475,745.3534,433.7531,745.0702,436.263,738.31" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="421.5944" y="741.9696">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="289.8955" y="806.935">0..1</text><!--MD5=[fabfb25c6922ca0223a52cadcead3358]
link PoRevokedService to PoHceService--><!--MD5=[553a2f1231a528299e1fdd03d75ee317]
link PoHceService to PoResource--><!--MD5=[49b2cd243b315032ac87ae560f8bd7c4]
reverse link SvSetting to Operation--><path d="M177.048,2040.25 C168.694,2061.061 158.316,2086.915 149.961,2107.73 " fill="none" id="SvSetting&lt;-Operation" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="179.7344" cy="2033.555" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="176.7538" x2="182.715" y1="2040.979" y2="2026.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="172.3104" x2="187.1584" y1="2030.5744" y2="2036.5356"/><!--MD5=[ad0f2bead1761192d1c3cbd4a713f69a]
reverse link SvSetting to Action--><path d="M208.912,2039.947 C218.462,2060.81 230.365,2086.814 239.94,2107.73 " fill="none" id="SvSetting&lt;-Action" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="205.9176" cy="2033.4052" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="209.2473" x2="202.588" y1="2040.6793" y2="2026.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="198.6435" x2="213.1918" y1="2036.7348" y2="2030.0755"/><!--MD5=[40b37511570e7b53b6592a746222781a]
reverse link SvSetting to LogRead--><path d="M234.136,2035.342 C262.655,2057.232 300.362,2086.175 329.876,2108.829 " fill="none" id="SvSetting&lt;-LogRead" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="228.481" cy="2031.0021" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="234.8271" x2="222.135" y1="2035.8733" y2="2026.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223.6099" x2="233.3522" y1="2037.3482" y2="2024.6561"/><!--MD5=[8d1c764bcc19989851e984ffe55e2961]
reverse link SvSetting to NegativeBalance--><path d="M267.647,2002 C274.331,2002 281.015,2002 287.7,2002 " fill="none" id="SvSetting&lt;-NegativeBalance" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="260.539" cy="2002" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="268.539" x2="252.539" y1="2002" y2="2002"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="260.539" x2="260.539" y1="2010" y2="1994"/><!--MD5=[e4e6b0c197a4fe408c8d4c7214bc9356]
link PoResource to PoTransaction--><path d="M300.751,1065.52 C315.668,1088.78 336.588,1121.39 360.511,1158.68 " fill="none" id="PoResource-&gt;PoTransaction" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="367.681,1169.86,367.8103,1162.6501,361.2046,1159.7577,361.0754,1166.9676,367.681,1169.86" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="297.1051" y="1086.6935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="355.154" y="1158.6611">1</text><!--MD5=[7ef23bb65cbd7f21990abf12f0f9fb41]
link PoSecuritySetting to PoTransaction--><path d="M600,750.14 C600,860.73 600,1014.49 600,1156.43 " fill="none" id="PoSecuritySetting-&gt;PoTransaction" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="600,1169.68,604,1163.68,600,1157.68,596,1163.68,600,1169.68" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="577.4672" y="771.5728">0..1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="592.9289" y="1159.6366">1</text><!--MD5=[4e36a4e3a201b7955d2f14bdee0043a9]
reverse link PoTransaction to SessionState--><path d="M537.024,1911.046 C534.148,1928.267 531.556,1943.786 529.367,1956.893 " fill="none" id="PoTransaction&lt;-SessionState" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="538.187" cy="1904.0867" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="536.8689" x2="539.505" y1="1911.9774" y2="1896.196"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="530.2963" x2="546.0776" y1="1902.7686" y2="1905.4047"/><!--MD5=[ce3c63ddc54d4d675759c68b3655a59d]
reverse link PoTransaction to SessionSetting--><path d="M678.302,1910.977 C684.021,1938.515 688.838,1961.705 692.15,1977.649 " fill="none" id="PoTransaction&lt;-SessionSetting" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="676.8578" cy="1904.0289" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="678.4845" x2="675.231" y1="1911.8617" y2="1896.196"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="669.0249" x2="684.6906" y1="1905.6556" y2="1902.4021"/><!--MD5=[01907a979ee07ab82f1dc532a4541c2c]
reverse link SessionSetting to EncryptionMode--><path d="M706.864,2040.857 C712.259,2061.563 718.918,2087.117 724.289,2107.73 " fill="none" id="SessionSetting&lt;-EncryptionMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="705.0445" cy="2033.8724" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="707.0619" x2="703.027" y1="2041.6139" y2="2026.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="697.303" x2="712.7859" y1="2035.8899" y2="2031.855"/><!--MD5=[19a5bab6cb0e733f5b38e95cd959a25a]
reverse link SessionSetting to ModificationMode--><path d="M657.978,2035.788 C632.412,2057.269 598.934,2085.399 572.357,2107.73 " fill="none" id="SessionSetting&lt;-ModificationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="663.3458" cy="2031.2771" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="657.2207" x2="669.471" y1="2036.4232" y2="2026.131"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="658.1997" x2="668.4919" y1="2025.1519" y2="2037.4023"/><!--MD5=[0e9a2e2ec4d6aea28d869b2d373dbe85]
reverse link SessionSetting to RatificationMode--><path d="M761.402,2032.65 C787.546,2045.394 817.719,2061.02 844,2077 C859.317,2086.313 875.345,2097.37 889.739,2107.832 " fill="none" id="SessionSetting&lt;-RatificationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="754.951" cy="2029.5436" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="762.1589" x2="747.743" y1="2033.0143" y2="2026.073"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="751.4803" x2="758.4216" y1="2036.7516" y2="2022.3357"/><!--MD5=[d0f8f68742f1a8058f4f2e5a0ad06650]
reverse link SessionSetting to AccessLevel--><path d="M748.843,2034.737 C773.817,2052.928 801.62,2078.095 817,2108 C839.265,2151.294 841.391,2207.947 839.471,2246.68 " fill="none" id="SessionSetting&lt;-AccessLevel" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="743.0605" cy="2030.7031" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="749.6211" x2="736.5" y1="2035.2813" y2="2026.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="738.4824" x2="747.6387" y1="2037.2637" y2="2024.1426"/><!--MD5=[37e957bec1fd56bfe0d2d70b2ed06b69]
link EncryptionMode to AccessLevel--><!--MD5=[aad50e08903197c6896398c3f9217d50]
reverse link SessionSetting to AuthenticationMode--><path d="M678.568,2039.923 C669.265,2059.725 658.411,2084.77 651,2108 C635.22,2157.462 624.321,2216.581 618.366,2253.964 " fill="none" id="SessionSetting&lt;-AuthenticationMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="681.6834" cy="2033.4384" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="678.2198" x2="685.147" y1="2040.6497" y2="2026.227"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="674.4721" x2="688.8948" y1="2029.9748" y2="2036.9019"/><!--MD5=[6952bc2877cf5d205c9a3c02c8dd195c]
link ModificationMode to AuthenticationMode--><!--MD5=[079f273270ef1dd73893779fe3d467bc]
reverse link PoTransaction to PinTransmissionMode--><path d="M765.923,1908.537 C770.832,1914.846 775.857,1921.008 781,1927 C792.991,1940.971 808.247,1953.367 823.611,1963.828 " fill="none" id="PoTransaction&lt;-PinTransmissionMode" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="761.4472" cy="1902.6133" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="766.2693" x2="756.625" y1="1908.9966" y2="1896.23"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="755.0638" x2="767.8305" y1="1907.4355" y2="1897.7912"/><!--MD5=[746f3c5b2505d7b38384202071141ba9]
reverse link PoTransaction to SvSetting--><path d="M273.648,1907.545 C248.274,1936.588 226.905,1961.047 212.401,1977.649 " fill="none" id="PoTransaction&lt;-SvSetting" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="278.2999" cy="1902.221" fill="#FFFFFF" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="273.0369" x2="283.563" y1="1908.2459" y2="1896.196"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="272.275" x2="284.3249" y1="1896.9579" y2="1907.484"/><!--MD5=[28e38a2b5aeddf77f446bb48690e6362]
link SessionState to SessionSetting--><!--MD5=[bc4e75526f74fbb68a5aed8e4c56686a]
link SessionSetting to PinTransmissionMode--><!--MD5=[15b34b46d09c17d92f3246bd8d6b690e]
link PinTransmissionMode to SvSetting--><!--MD5=[3429ec821e60fb1fffd23386c89f33c5]
link PoTransaction to SelectFileControl--><path d="M982.211,1822.162 C1017.87,1875.702 1041,1935.625 1041,2001 C1041,2001 1041,2001 1041,2293 C1041,2334.447 1013.83,2372.466 986.873,2399.986 " fill="none" id="PoTransaction-SelectFileControl" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[75cf09f748786ce5d6dd001ad977eb2a]
link AuthenticationMode to SelectFileControl--><!--MD5=[1cfe505a46771159e49acdb3572284bd]
@startuml
skinparam ClassBorderColor #D4AC0D
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
skinparam shadowing false

skinparam StateBorderColor #D4AC0D
skinparam ActivityBorderColor #D4AC0D

skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #EAFAF1
skinparam ClassBorderColor<<green>> #2ECC71
hide <<green>> stereotype

skinparam ClassBackgroundColor<<orange>> #FDF2E9
skinparam ClassBorderColor<<orange>> #E67E22
hide <<orange>> stereotype

skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

together {
  together {
+class "static <b>final</b> PoSecuritySettingBuilder" as PoSecuritySettingBuilder {
  -final SamResource samResource
  -List<Byte> authorizedKvcList
  -final EnumMap<AccessLevel, Byte> defaultKif
  -final EnumMap<AccessLevel, Byte> defaultKvc
  -final EnumMap<AccessLevel, Byte> defaultKeyRecordNumber
  ModificationMode sessionModificationMode = ATOMIC
  RatificationMode ratificationMode = CLOSE_RATIFIED

  +PoSecuritySettingBuilder(SamResource samResource)

  +PoSecuritySettingBuilder sessionModificationMode(ModificationMode sessionModificationMode)
  +PoSecuritySettingBuilder ratificationMode(RatificationMode ratificationMode)
  +PoSecuritySettingBuilder sessionDefaultKif(AccessLevel sessionAccessLevel, byte kif)
  +PoSecuritySettingBuilder sessionDefaultKvc(AccessLevel sessionAccessLevel, byte kvc)
  +PoSecuritySettingBuilder sessionDefaultKeyRecordNumber(AccessLevel sessionAccessLevel,
    byte keyRecordNumber)
  +PoSecuritySettingBuilder sessionAuthorizedKvcList(List<Byte> authorizedKvcList)

  +PoSecuritySetting build()
}

+class "<b>final</b> PoSecuritySetting" as PoSecuritySetting {
  +PoSecuritySetting(SamResource samResource);
  #PoRevokedService getPoRevokedService()
  #SamRevokedService getSamRevokedService()
  #PoHceService getPoHceService()

  +loadProperties(Properties propertyFile)

  #ModificationMode getSessionModificationMode()
  #RatificationMode getSessionRatificationMode()
  #Byte getSessionDefaultKif(AccessLevel level)
  #Byte getSessionDefaultKvc(AccessLevel level)
  #Byte getSessionDefaultKeyRecordNumber(AccessLevel level)
  #Boolean isSessionKvcAuthorized(byte kvc)

  #PinTransmissionMode getPinTransmissionMode()

  #LogRead getSvGetLogReadMode()
  #NegativeBalance getSvNegativeBalance()
  #Boolean isSvKvcAuthorized(byte kvc)
}

note as N1
Default values in PoTransaction if PoSecuritySetting doesn't specify it:
  - session ModificationMode as ATOMIC
  - session RatificationMode as CLOSE_RATIFIED
  - PinTransmissionMode as ENCRYPTED if PoSecurity defined
  - any KIF/KVC values are authorized
  - no verification is done for: HCE token expiration, revoked PO or SAM
end note

    PoSecuritySettingBuilder .right. N1
    PoSecuritySettingBuilder -down- PoSecuritySetting : build >

    together {
      interface SamRevokedService

      +class "SeResource<CalypsoSam>" as SamResource {
        +SeResource(<color:red>SeReader seReader</color>,
          CalypsoSam sam);
      }

      +class "<b>final</b> CalypsoSam" as CalypsoSam {
        ~CalypsoSam(<color:red>SeResponse selectionResponse</color>)

        +SamRevision getSamRevision()
        +byte[] getSerialNumber()
        +byte getPlatform()
        +byte getApplicationType()
        +byte getApplicationSubType()
        +byte getSoftwareIssuer()
      }
    }
    PoSecuritySetting "1" o-right- "0..1" SamRevokedService
    PoSecuritySetting "1 " o-right- " 0..1" SamResource
    SamRevokedService -down[hidden]- SamResource
    SamResource "1" o-down- "1" CalypsoSam

    together {
      interface PoRevokedService
      interface PoHceService

      +class "SeResource<CalypsoPo>" as PoResource {
        +SeResource(<color:red>SeReader seReader</color>,
          CalypsoPo po);
      }
    }
    PoRevokedService "0..1" -right-o "1" PoSecuritySetting
    PoHceService "0..1 " -right-o " 1" PoSecuritySetting
    PoRevokedService -down[hidden]- PoHceService
    PoHceService -down[hidden]- PoResource

+interface SamRevokedService {
  +boolean isSamRevoked(byte[] 4bytesSerial, byte[][0..1] 3bytesCounter)
}

+interface PoRevokedService {
  +boolean isPoRevoked(byte[] 8bytesSerial)
}

+interface PoHceService {
  +boolean isCalypsoSerialExpired(byte[] 2bytesExpirationData)
}
+class PoTransaction {
  +PoTransaction(PoResource poResource, PoSecuritySetting[0..1] securitySetting)

  +<b>final</b> prepareReleaseChannel()

  +<b>final</b> processPoCommands()
  +<b>final</b> processOpening(AccessLevel level)
  +<b>final</b> processClosing()
  +<b>final</b> processCancel()
  +<b>final</b> prepareManageSession(EncryptionMode encMode, AuthenticationMode authMode)
  +<b>final</b> SessionSecureData getSessionSecureData()

  +<b>final</b> prepareCheckPinStatus()
  +<b>final</b> processVerifyPin(String pin)
  +<b>final</b> processVerifyPin(byte[] pin)

  +<b>final</b> prepareSvGet(SvSetting.Operation operation, SvSetting.Action action)
  +<b>final</b> prepareSvReload(int amount, int date, int time, String free)
  +<b>final</b> prepareSvReload(int amount, byte[] date, byte[] time, byte[] free)
  +<b>final</b> prepareSvReload(int amount)
  +<b>final</b> prepareSvDebit(int amount, int date, int time)
  +<b>final</b> prepareSvDebit(int amount, byte[] date, byte[] time)
  +<b>final</b> prepareSvDebit(int amount)
  +<b>final</b> SvOperationSecureData getSvOperationSecureData()

  +<b>final</b> prepareSelectFile(short lid)
  +<b>final</b> prepareSelectFile(byte[] lid)
  +<b>final</b> prepareSelectFile(SelectFileControl control)
  +<b>final</b> prepareReadRecordFile(byte sfi, int recordNumber)
  +<b>final</b> prepareReadRecordFile(byte sfi, int firstRecordNumber, int numberOfRecords, int recordSize))
  +<b>final</b> prepareReadSubRecordFile(byte sfi, int firstRecordNumber, int numberOfRecord, int recordOffset, int recordLength)
  +<b>final</b> prepareReadBinaryFile(byte sfi, int dataLength, int[0..1] dataOffset)
  +<b>final</b> prepareReadCounterFile(byte sfi, int countersNumber)
  +<b>final</b> prepareAppendRecord(byte sfi, byte[] recordData)
  +<b>final</b> prepareUpdateRecord(byte sfi, int recordNumber, byte[] recordData)
  +<b>final</b> prepareWriteRecord(byte sfi, int recordNumber, byte[] recordData)
  +<b>final</b> prepareUpdateBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)
  +<b>final</b> prepareWriteBinaryFile(byte sfi, byte[] fileData, int[0..1] dataOffset)
  +<b>final</b> prepareIncreaseCounter(byte sfi, int counterNumber, int incValue)
  +<b>final</b> prepareDecreaseCounter(byte sfi, int counterNumber, int decValue)
  +<b>final</b> prepareSetCounter(byte sfi, int counterNumber, int newValue)
  +<b>final</b> int prepareSearchRecord(byte sfi, byte offset, SearchOffsetMode offsetMode, byte[] searchData, Byte[] searchMask, SearchReadMode readMode)
  +<b>final</b> int[] getSearchResult(int searchRequestNumber)

  +<b>final</b> prepareInvalidate()
  +<b>final</b> prepareRehabilitate()

  +<b>final</b> prepareChangeKey(AccessLevel level)
  +<b>final</b> prepareChangePin(String pin)
  +<b>final</b> prepareChangePin(byte[] pin)
}
-enum SessionState {
  SESSION_UNITIALIZED,
  SESSION_OPEN,
  SESSION_CLOSED
}

+class "<b>final</b> SessionSetting" as SessionSetting {
}

+enum AccessLevel {
  SESSION_LVL_PERSO("perso", byte 0x01),
  SESSION_LVL_LOAD("load", byte 0x02),
  SESSION_LVL_DEBIT("debit", byte 0x03)
}

+enum ModificationMode {
  ATOMIC,
  MULTIPLE
}

+enum RatificationMode {
  CLOSE_RATIFIED,
  CLOSE_NOT_RATIFIED
}

+enum EncryptionMode {
  ACTIVATE,
  DEACTIVATE
}

+enum AuthenticationMode {
  REQUESTED,
  NOT_REQUESTED
}

+enum PinTransmissionMode {
  PLAIN,
  ENCRYPTED
}

together {
  +class "<b>final</b> SvSetting" as SvSetting {
  }

  +enum Operation {
    RELOAD,
    DEBIT
  }

  +enum Action {
    DO,
    UNDO
  }

  +enum LogRead {
    SINGLE,
    ALL
  }

  +enum NegativeBalance {
    FORBIDDEN,
    AUTHORIZED
  }
}

    SvSetting +-down- Operation
    SvSetting +-down- Action
    SvSetting +-down- LogRead
    SvSetting +-right- NegativeBalance

    PoResource "1" - -o "1" PoTransaction
    PoTransaction "1" o-up- "0..1" PoSecuritySetting

    PoTransaction +-down- SessionState

    PoTransaction +-down- SessionSetting
    SessionSetting +-down- EncryptionMode
    SessionSetting +-down- ModificationMode
    SessionSetting +-down- RatificationMode
    SessionSetting +- - AccessLevel
    EncryptionMode -down[hidden]- AccessLevel
    SessionSetting +- - AuthenticationMode
    ModificationMode -down[hidden]- AuthenticationMode

    PoTransaction +-down- PinTransmissionMode
    PoTransaction +-down- SvSetting

    SessionState -right[hidden]- SessionSetting
    SessionSetting -right[hidden]- PinTransmissionMode
    PinTransmissionMode -right[hidden]- SvSetting
  }

+enum SelectFileControl {
  FIRST_EF,
  NEXT_EF,
  CURRENT_DF
}

  PoTransaction - - SelectFileControl
  AuthenticationMode -down[hidden]- SelectFileControl
}
@enduml

PlantUML version 1.2020.09(Sun May 10 14:51:06 MUT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-b765.64
Operating System: Windows 10
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>